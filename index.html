<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å››æŸ±å…«å­—æ’ç›˜ç³»ç»Ÿ - ä¸“ä¸šç‰ˆ v2.0</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/lunar-javascript@1.6.12/lunar.js"></script>
    <!-- Version: 2.0 - Fixed daily interpretation -->
    <style>
        body { 
            font-family: "Microsoft YaHei", "PingFang SC", sans-serif; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .gan { font-weight: bold; }
        .zhi { font-weight: bold; }
        
        /* äº”è¡Œç€è‰² */
        .wuxing-é‡‘ { color: #d97706; }
        .wuxing-æœ¨ { color: #16a34a; }
        .wuxing-æ°´ { color: #2563eb; }
        .wuxing-ç« { color: #dc2626; }
        .wuxing-åœŸ { color: #78350f; }
        
        .interaction-tag {
            font-size: 0.75rem;
            padding: 2px 6px;
            border-radius: 4px;
            margin-right: 4px;
            margin-bottom: 2px;
            display: inline-block;
            font-weight: 500;
        }
        .tag-chong { background-color: #fee2e2; color: #991b1b; border: 1px solid #fca5a5; }
        .tag-he { background-color: #dcfce7; color: #166534; border: 1px solid #86efac; }
        .tag-xing { background-color: #fef3c7; color: #92400e; border: 1px solid #fcd34d; }
        .tag-hai { background-color: #e0e7ff; color: #3730a3; border: 1px solid #a5b4fc; }
        .tag-po { background-color: #ffe4e6; color: #9f1239; border: 1px solid #fda4af; }
        
        .shensha-tag {
            font-size: 0.7rem;
            padding: 1px 5px;
            border-radius: 3px;
            margin: 2px;
            display: inline-block;
            background-color: #f3e8ff;
            color: #6b21a8;
            border: 1px solid #d8b4fe;
        }
        
        .pillar-card {
            transition: transform 0.2s;
        }
        .pillar-card:hover {
            transform: translateY(-5px);
        }
        
        .calendar-row:hover {
            background-color: #f9fafb !important;
        }
    </style>
</head>
<body class="p-4 md:p-8">
    <div class="max-w-7xl mx-auto">
        <!-- ä¸»å®¹å™¨ -->
        <div class="bg-white shadow-2xl rounded-2xl overflow-hidden">
            <!-- å¤´éƒ¨è¾“å…¥åŒº -->
            <div class="p-6 bg-gradient-to-r from-gray-800 to-gray-900 text-white">
                <h1 class="text-3xl font-bold mb-2 flex items-center">
                    <span class="mr-3">ğŸ”®</span>
                    å››æŸ±å…«å­—æ’ç›˜ç³»ç»Ÿ
                    <span class="ml-3 text-sm font-normal text-gray-300">ä¸“ä¸šç‰ˆ</span>
                </h1>
                <p class="text-gray-400 text-sm mb-6">åŒ…å«æµå¹´æµæœˆæµæ—¥åˆ†æã€ç¥ç…è¯¦æ‰¹ã€åˆ‘å†²åˆå®³ç­‰åŠŸèƒ½</p>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4 items-end">
                    <div>
                        <label class="block text-sm text-gray-300 mb-2">ğŸ‘¤ å§“å</label>
                        <input type="text" id="userName" 
                               class="w-full p-3 rounded-lg text-gray-900 border-2 border-gray-600 focus:border-blue-500 focus:outline-none" 
                               placeholder="è¯·è¾“å…¥å§“å">
                    </div>
                    <div>
                        <label class="block text-sm text-gray-300 mb-2">âš¥ æ€§åˆ«</label>
                        <select id="userGender" 
                                class="w-full p-3 rounded-lg text-gray-900 border-2 border-gray-600 focus:border-blue-500 focus:outline-none">
                            <option value="1">ç”·</option>
                            <option value="0">å¥³</option>
                        </select>
                    </div>
                    <div class="md:col-span-2">
                        <label class="block text-sm text-gray-300 mb-2">ğŸ“… å‡ºç”Ÿæ—¥æœŸï¼ˆå…¬å†ï¼‰</label>
                        <input type="datetime-local" id="birthDate" 
                               class="w-full p-3 rounded-lg text-gray-900 border-2 border-gray-600 focus:border-blue-500 focus:outline-none" 
                               value="1995-07-02T19:55">
                    </div>
                    <div>
                        <label class="block text-sm text-gray-300 mb-2">ğŸ“† æŸ¥çœ‹æµå¹´</label>
                        <input type="number" id="targetYear" 
                               class="w-full p-3 rounded-lg text-gray-900 border-2 border-gray-600 focus:border-blue-500 focus:outline-none" 
                               value="2025">
                    </div>
                    <div>
                        <label class="block text-sm text-gray-300 mb-2">ğŸŒ™ æŸ¥çœ‹æµæœˆ</label>
                        <select id="targetMonth" 
                                class="w-full p-3 rounded-lg text-gray-900 border-2 border-gray-600 focus:border-blue-500 focus:outline-none">
                            <option value="1">1æœˆ</option><option value="2">2æœˆ</option><option value="3">3æœˆ</option>
                            <option value="4">4æœˆ</option><option value="5">5æœˆ</option><option value="6">6æœˆ</option>
                            <option value="7">7æœˆ</option><option value="8">8æœˆ</option><option value="9">9æœˆ</option>
                            <option value="10">10æœˆ</option><option value="11" selected>11æœˆ</option><option value="12">12æœˆ</option>
                        </select>
                    </div>
                </div>
                <div class="mt-4">
                    <button onclick="calculate()" 
                            class="w-full bg-gradient-to-r from-blue-600 to-blue-500 hover:from-blue-500 hover:to-blue-400 text-white font-bold py-3 px-6 rounded-lg transition transform hover:scale-105 shadow-lg">
                        ğŸ” å¼€å§‹æ’ç›˜
                    </button>
                </div>
            </div>

            <!-- å…«å­—æ’ç›˜ç»“æœ -->
            <div id="baziResult" class="p-6 border-b-4 border-gray-200 bg-white" style="display:none;">
                <!-- JSåŠ¨æ€å¡«å…… -->
            </div>

            <!-- åŸå±€å±•ç¤ºåŒº -->
            <div class="p-6 border-b-4 border-gray-200 bg-gradient-to-br from-gray-50 to-gray-100">
                <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                    <span class="mr-2">ğŸ¯</span>
                    å‘½ä¸»åŸå±€ï¼ˆå››æŸ±å…«å­—ï¼‰
                </h2>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4" id="natalChart">
                    <!-- JSå¡«å…… -->
                </div>
                <!-- å¤§è¿è¯¦ç»†ä¿¡æ¯ -->
                <div class="mt-6 pt-6 border-t border-gray-300">
                    <h3 class="text-lg font-bold text-gray-700 mb-3 flex items-center">
                        <span class="mr-2">â°</span>
                        å¤§è¿è¯¦æ‰¹
                    </h3>
                    <div class="overflow-x-auto">
                        <div id="dayunDetailTable">
                            <!-- JSå¡«å……å¤§è¿è¯¦ç»†è¡¨æ ¼ -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- æµæ—¥åˆ—è¡¨åŒº -->
            <div class="p-6">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-bold text-gray-800 flex items-center">
                        <span class="mr-2">ğŸ“‹</span>
                        <span id="calendarTitle">æµæ—¥è¯¦ç»†è¿ç¨‹</span>
                    </h2>
                    <div class="text-sm text-gray-500">
                        <span class="mr-4">ğŸ’¡ æç¤ºï¼šæ—¥è±¡è§£è¯»ç»¼åˆåˆ†ææ¯æ—¥å‰å‡¶å®œå¿Œ</span>
                    </div>
                </div>
                
                <div class="overflow-x-auto rounded-lg border border-gray-200">
                    <table class="w-full text-left border-collapse">
                        <thead>
                            <tr class="bg-gradient-to-r from-gray-700 to-gray-800 text-white text-sm uppercase tracking-wider">
                                <th class="p-4 border-b border-gray-600">å…¬å†æ—¥æœŸ</th>
                                <th class="p-4 border-b border-gray-600">å†œå†</th>
                                <th class="p-4 border-b border-gray-600">æµå¹´å¹²æ”¯</th>
                                <th class="p-4 border-b border-gray-600">æµæœˆå¹²æ”¯</th>
                                <th class="p-4 border-b border-gray-600">æµæ—¥å¹²æ”¯</th>
                                <th class="p-4 border-b border-gray-600">å¤©å¹²ç•™æ„</th>
                                <th class="p-4 border-b border-gray-600">åœ°æ”¯ç•™æ„</th>
                                <th class="p-4 border-b border-gray-600">ç¥ç…è¯¦æ‰¹</th>
                                <th class="p-4 border-b border-gray-600 w-64">æ—¥è±¡è§£è¯»</th>
                            </tr>
                        </thead>
                        <tbody id="dailyTable" class="text-sm divide-y divide-gray-200">
                            <!-- JSå¡«å……è¡Œ -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- é¡µè„šè¯´æ˜ -->
        <div class="mt-6 text-center text-white text-sm">
            <p class="mb-2">ğŸ’« ä¸“ä¸šå››æŸ±å…«å­—æ’ç›˜ç³»ç»Ÿ | åŒ…å«å¤©ä¹™è´µäººã€çº¢è‰³ã€æ¡ƒèŠ±ã€é©¿é©¬ç­‰30+ç¥ç…</p>
            <p class="text-gray-300 text-xs">ä»…ä¾›å‚è€ƒï¼Œè¯·ç†æ€§çœ‹å¾…</p>
        </div>
    </div>

    <script>
        // ============ åŸºç¡€æ•°æ®å®šä¹‰ ============
        const WUXING_MAP = {
            'ç”²':'æœ¨','ä¹™':'æœ¨','ä¸™':'ç«','ä¸':'ç«','æˆŠ':'åœŸ','å·±':'åœŸ',
            'åºš':'é‡‘','è¾›':'é‡‘','å£¬':'æ°´','ç™¸':'æ°´',
            'å­':'æ°´','ä¸‘':'åœŸ','å¯…':'æœ¨','å¯':'æœ¨','è¾°':'åœŸ','å·³':'ç«',
            'åˆ':'ç«','æœª':'åœŸ','ç”³':'é‡‘','é…‰':'é‡‘','æˆŒ':'åœŸ','äº¥':'æ°´'
        };

        // å¤©å¹²åœ°æ”¯å…³ç³»
        const RELATIONS = {
            // å¤©å¹²äº”åˆ
            GanHe: {'ç”²':'å·±','å·±':'ç”²','ä¹™':'åºš','åºš':'ä¹™','ä¸™':'è¾›','è¾›':'ä¸™','ä¸':'å£¬','å£¬':'ä¸','æˆŠ':'ç™¸','ç™¸':'æˆŠ'},
            // å¤©å¹²ç›¸å†²
            GanChong: {'ç”²':'åºš','åºš':'ç”²','ä¹™':'è¾›','è¾›':'ä¹™','ä¸™':'å£¬','å£¬':'ä¸™','ä¸':'ç™¸','ç™¸':'ä¸'},
            // åœ°æ”¯å…­åˆ
            ZhiLiuHe: {'å­':'ä¸‘','ä¸‘':'å­','å¯…':'äº¥','äº¥':'å¯…','å¯':'æˆŒ','æˆŒ':'å¯','è¾°':'é…‰','é…‰':'è¾°','å·³':'ç”³','ç”³':'å·³','åˆ':'æœª','æœª':'åˆ'},
            // åœ°æ”¯ç›¸å†²
            ZhiChong: {'å­':'åˆ','åˆ':'å­','ä¸‘':'æœª','æœª':'ä¸‘','å¯…':'ç”³','ç”³':'å¯…','å¯':'é…‰','é…‰':'å¯','è¾°':'æˆŒ','æˆŒ':'è¾°','å·³':'äº¥','äº¥':'å·³'},
            // åœ°æ”¯ä¸‰åˆ
            ZhiSanHe: {
                'ç”³å­è¾°': ['ç”³','å­','è¾°'], // æ°´å±€
                'äº¥å¯æœª': ['äº¥','å¯','æœª'], // æœ¨å±€
                'å¯…åˆæˆŒ': ['å¯…','åˆ','æˆŒ'], // ç«å±€
                'å·³é…‰ä¸‘': ['å·³','é…‰','ä¸‘']  // é‡‘å±€
            },
            // åœ°æ”¯ç›¸åˆ‘
            ZhiXing: {
                'å¯…': ['å·³','ç”³'], 'å·³': ['ç”³','å¯…'], 'ç”³': ['å¯…','å·³'], // æ— æ©ä¹‹åˆ‘
                'ä¸‘': ['æˆŒ','æœª'], 'æˆŒ': ['æœª','ä¸‘'], 'æœª': ['ä¸‘','æˆŒ'], // æŒåŠ¿ä¹‹åˆ‘
                'å­': ['å¯'], 'å¯': ['å­'], // æ— ç¤¼ä¹‹åˆ‘
                'è¾°': ['è¾°'], 'åˆ': ['åˆ'], 'é…‰': ['é…‰'], 'äº¥': ['äº¥'] // è‡ªåˆ‘
            },
            // åœ°æ”¯ç›¸å®³
            ZhiHai: {'å­':'æœª','æœª':'å­','ä¸‘':'åˆ','åˆ':'ä¸‘','å¯…':'å·³','å·³':'å¯…','å¯':'è¾°','è¾°':'å¯','ç”³':'äº¥','äº¥':'ç”³','é…‰':'æˆŒ','æˆŒ':'é…‰'},
            // åœ°æ”¯ç›¸ç ´
            ZhiPo: {'å­':'é…‰','é…‰':'å­','ä¸‘':'è¾°','è¾°':'ä¸‘','å¯…':'äº¥','äº¥':'å¯…','å¯':'åˆ','åˆ':'å¯','å·³':'ç”³','ç”³':'å·³','æœª':'æˆŒ','æˆŒ':'æœª'}
        };

        // ============ ç¥ç…æ•°æ®åº“ï¼ˆç›²æ´¾åŠä¼ ç»Ÿç¥ç…ï¼‰============
        const SHENSHA = {
            // å¤©ä¹™è´µäººï¼ˆæ—¥å¹²æŸ¥åœ°æ”¯ï¼‰
            TianYi: {
                'ç”²': ['ä¸‘','æœª'], 'æˆŠ': ['ä¸‘','æœª'],
                'ä¹™': ['å­','ç”³'], 'å·±': ['å­','ç”³'],
                'ä¸™': ['äº¥','é…‰'], 'ä¸': ['äº¥','é…‰'],
                'åºš': ['ä¸‘','æœª'], 'è¾›': ['å¯…','åˆ'],
                'å£¬': ['å¯','å·³'], 'ç™¸': ['å¯','å·³']
            },
            // å¤©å¾·è´µäººï¼ˆæœˆæ”¯æŸ¥åœ°æ”¯ï¼‰
            TianDe: {
                'å¯…': ['ä¸'], 'å¯': ['ç”³'], 'è¾°': ['å£¬'], 'å·³': ['è¾›'],
                'åˆ': ['äº¥'], 'æœª': ['ç”²'], 'ç”³': ['ç™¸'], 'é…‰': ['å¯…'],
                'æˆŒ': ['ä¸™'], 'äº¥': ['ä¹™'], 'å­': ['å·³'], 'ä¸‘': ['åºš']
            },
            // æœˆå¾·è´µäººï¼ˆæœˆæ”¯æŸ¥åœ°æ”¯ï¼‰
            YueDe: {
                'å¯…': ['ä¸™'], 'å¯': ['ç”²'], 'è¾°': ['å£¬'], 'å·³': ['åºš'],
                'åˆ': ['ä¸™'], 'æœª': ['ç”²'], 'ç”³': ['å£¬'], 'é…‰': ['åºš'],
                'æˆŒ': ['ä¸™'], 'äº¥': ['ç”²'], 'å­': ['å£¬'], 'ä¸‘': ['åºš']
            },
            // æ–‡æ˜Œè´µäººï¼ˆæ—¥å¹²æŸ¥åœ°æ”¯ï¼‰
            WenChang: {
                'ç”²': ['å·³'], 'ä¹™': ['åˆ'], 'ä¸™': ['ç”³'], 'ä¸': ['é…‰'],
                'æˆŠ': ['ç”³'], 'å·±': ['é…‰'], 'åºš': ['äº¥'], 'è¾›': ['å­'],
                'å£¬': ['å¯…'], 'ç™¸': ['å¯']
            },
            // æ¡ƒèŠ±ï¼ˆæ—¥æ”¯æˆ–å¹´æ”¯æŸ¥åœ°æ”¯ï¼‰
            TaoHua: {
                'å¯…': ['å¯'], 'åˆ': ['å¯'], 'æˆŒ': ['å¯'], // å¯…åˆæˆŒè§å¯
                'ç”³': ['é…‰'], 'å­': ['é…‰'], 'è¾°': ['é…‰'], // ç”³å­è¾°è§é…‰
                'äº¥': ['å­'], 'å¯': ['å­'], 'æœª': ['å­'], // äº¥å¯æœªè§å­
                'å·³': ['åˆ'], 'é…‰': ['åˆ'], 'ä¸‘': ['åˆ']  // å·³é…‰ä¸‘è§åˆ
            },
            // çº¢è‰³ï¼ˆæ—¥å¹²æŸ¥åœ°æ”¯ï¼‰
            HongYan: {
                'ç”²': ['åˆ'], 'ä¹™': ['ç”³'], 'ä¸™': ['å¯…'], 'ä¸': ['æœª'],
                'æˆŠ': ['è¾°'], 'å·±': ['è¾°'], 'åºš': ['æˆŒ'], 'è¾›': ['é…‰'],
                'å£¬': ['å­'], 'ç™¸': ['ç”³']
            },
            // é©¿é©¬ï¼ˆæ—¥æ”¯æˆ–å¹´æ”¯æŸ¥åœ°æ”¯ï¼‰
            YiMa: {
                'å¯…': ['ç”³'], 'åˆ': ['ç”³'], 'æˆŒ': ['ç”³'],
                'ç”³': ['å¯…'], 'å­': ['å¯…'], 'è¾°': ['å¯…'],
                'äº¥': ['å·³'], 'å¯': ['å·³'], 'æœª': ['å·³'],
                'å·³': ['äº¥'], 'é…‰': ['äº¥'], 'ä¸‘': ['äº¥']
            },
            // åç›–ï¼ˆæ—¥æ”¯æˆ–å¹´æ”¯æŸ¥åœ°æ”¯ï¼‰
            HuaGai: {
                'å¯…': ['æˆŒ'], 'åˆ': ['æˆŒ'], 'æˆŒ': ['æˆŒ'],
                'ç”³': ['è¾°'], 'å­': ['è¾°'], 'è¾°': ['è¾°'],
                'äº¥': ['æœª'], 'å¯': ['æœª'], 'æœª': ['æœª'],
                'å·³': ['ä¸‘'], 'é…‰': ['ä¸‘'], 'ä¸‘': ['ä¸‘']
            },
            // å°†æ˜Ÿï¼ˆæ—¥æ”¯æˆ–å¹´æ”¯æŸ¥åœ°æ”¯ï¼‰
            JiangXing: {
                'å¯…': ['åˆ'], 'åˆ': ['åˆ'], 'æˆŒ': ['åˆ'],
                'ç”³': ['å­'], 'å­': ['å­'], 'è¾°': ['å­'],
                'äº¥': ['å¯'], 'å¯': ['å¯'], 'æœª': ['å¯'],
                'å·³': ['é…‰'], 'é…‰': ['é…‰'], 'ä¸‘': ['é…‰']
            },
            // å­¤è¾°å¯¡å®¿ï¼ˆå¹´æ”¯æŸ¥åœ°æ”¯ï¼‰
            GuChen: {
                'å¯…': ['å·³'], 'åˆ': ['å·³'], 'æˆŒ': ['å·³'],
                'ç”³': ['äº¥'], 'å­': ['äº¥'], 'è¾°': ['äº¥'],
                'äº¥': ['å¯…'], 'å¯': ['å¯…'], 'æœª': ['å¯…'],
                'å·³': ['ç”³'], 'é…‰': ['ç”³'], 'ä¸‘': ['ç”³']
            },
            GuaSu: {
                'å¯…': ['ä¸‘'], 'åˆ': ['ä¸‘'], 'æˆŒ': ['ä¸‘'],
                'ç”³': ['æœª'], 'å­': ['æœª'], 'è¾°': ['æœª'],
                'äº¥': ['æˆŒ'], 'å¯': ['æˆŒ'], 'æœª': ['æˆŒ'],
                'å·³': ['è¾°'], 'é…‰': ['è¾°'], 'ä¸‘': ['è¾°']
            },
            // ç¾Šåˆƒï¼ˆæ—¥å¹²æŸ¥åœ°æ”¯ï¼‰
            YangRen: {
                'ç”²': ['å¯'], 'ä¹™': ['å¯…'], 'ä¸™': ['åˆ'], 'ä¸': ['å·³'],
                'æˆŠ': ['åˆ'], 'å·±': ['å·³'], 'åºš': ['é…‰'], 'è¾›': ['ç”³'],
                'å£¬': ['å­'], 'ç™¸': ['äº¥']
            },
            // ç¦„ç¥ï¼ˆæ—¥å¹²æŸ¥åœ°æ”¯ï¼‰
            LuShen: {
                'ç”²': ['å¯…'], 'ä¹™': ['å¯'], 'ä¸™': ['å·³'], 'ä¸': ['åˆ'],
                'æˆŠ': ['å·³'], 'å·±': ['åˆ'], 'åºš': ['ç”³'], 'è¾›': ['é…‰'],
                'å£¬': ['äº¥'], 'ç™¸': ['å­']
            },
            // åŠ«ç…ï¼ˆå¹´æ”¯æˆ–æ—¥æ”¯æŸ¥åœ°æ”¯ï¼‰
            JieSha: {
                'å¯…': ['äº¥'], 'åˆ': ['äº¥'], 'æˆŒ': ['äº¥'],
                'ç”³': ['å·³'], 'å­': ['å·³'], 'è¾°': ['å·³'],
                'äº¥': ['ç”³'], 'å¯': ['ç”³'], 'æœª': ['ç”³'],
                'å·³': ['å¯…'], 'é…‰': ['å¯…'], 'ä¸‘': ['å¯…']
            },
            // ç¾ç…ï¼ˆå¹´æ”¯æˆ–æ—¥æ”¯æŸ¥åœ°æ”¯ï¼‰
            ZaiSha: {
                'å¯…': ['åˆ'], 'åˆ': ['åˆ'], 'æˆŒ': ['åˆ'],
                'ç”³': ['å­'], 'å­': ['å­'], 'è¾°': ['å­'],
                'äº¥': ['å¯'], 'å¯': ['å¯'], 'æœª': ['å¯'],
                'å·³': ['é…‰'], 'é…‰': ['é…‰'], 'ä¸‘': ['é…‰']
            },
            // äº¡ç¥ï¼ˆå¹´æ”¯æˆ–æ—¥æ”¯æŸ¥åœ°æ”¯ï¼‰
            WangShen: {
                'å¯…': ['å·³'], 'åˆ': ['å·³'], 'æˆŒ': ['å·³'],
                'ç”³': ['äº¥'], 'å­': ['äº¥'], 'è¾°': ['äº¥'],
                'äº¥': ['å¯…'], 'å¯': ['å¯…'], 'æœª': ['å¯…'],
                'å·³': ['ç”³'], 'é…‰': ['ç”³'], 'ä¸‘': ['ç”³']
            },
            // å¤©åŒ»ï¼ˆæ—¥å¹²æŸ¥åœ°æ”¯ï¼‰
            TianYi2: {
                'ç”²': ['ä¸‘'], 'ä¹™': ['å­'], 'ä¸™': ['äº¥'], 'ä¸': ['é…‰'],
                'æˆŠ': ['ä¸‘'], 'å·±': ['å­'], 'åºš': ['ä¸‘'], 'è¾›': ['å¯…'],
                'å£¬': ['å¯'], 'ç™¸': ['å·³']
            },
            // é‡‘èˆ†ï¼ˆæ—¥æ”¯æŸ¥åœ°æ”¯ï¼‰
            JinYu: {
                'å¯…': ['æˆŒ'], 'åˆ': ['æˆŒ'], 'æˆŒ': ['æˆŒ'],
                'ç”³': ['è¾°'], 'å­': ['è¾°'], 'è¾°': ['è¾°'],
                'äº¥': ['æœª'], 'å¯': ['æœª'], 'æœª': ['æœª'],
                'å·³': ['ä¸‘'], 'é…‰': ['ä¸‘'], 'ä¸‘': ['ä¸‘']
            },
            // å¤©ç½—åœ°ç½‘ï¼ˆåœ°æ”¯æœ¬èº«ï¼‰
            TianLuo: ['æˆŒ', 'äº¥'],
            DiWang: ['è¾°', 'å·³'],
            // å…ƒè¾°ï¼ˆå¹´æ”¯æŸ¥åœ°æ”¯ï¼‰
            YuanChen: {
                'å­': ['æœª'], 'ä¸‘': ['ç”³'], 'å¯…': ['é…‰'], 'å¯': ['æˆŒ'],
                'è¾°': ['äº¥'], 'å·³': ['å­'], 'åˆ': ['ä¸‘'], 'æœª': ['å¯…'],
                'ç”³': ['å¯'], 'é…‰': ['è¾°'], 'æˆŒ': ['å·³'], 'äº¥': ['åˆ']
            },
            // å’¸æ± ï¼ˆå¹´æ”¯æˆ–æ—¥æ”¯æŸ¥åœ°æ”¯ï¼‰
            XianChi: {
                'å¯…': ['å¯'], 'åˆ': ['å¯'], 'æˆŒ': ['å¯'],
                'ç”³': ['é…‰'], 'å­': ['é…‰'], 'è¾°': ['é…‰'],
                'äº¥': ['å­'], 'å¯': ['å­'], 'æœª': ['å­'],
                'å·³': ['åˆ'], 'é…‰': ['åˆ'], 'ä¸‘': ['åˆ']
            },
            // ç©ºäº¡ï¼ˆæ—¬ç©ºï¼Œç”±å‡ºç”Ÿæ—¥æŸ±æ—¬å†³å®šï¼‰
            // è¿™ä¸ªéœ€è¦ç‰¹æ®Šå¤„ç†ï¼Œä¸åœ¨è¿™é‡Œå®šä¹‰
            // ç™½è™ï¼ˆå¹´æ”¯æŸ¥åœ°æ”¯ï¼‰
            BaiHu: {
                'å¯…': ['ç”³'], 'å¯': ['é…‰'], 'è¾°': ['æˆŒ'], 'å·³': ['äº¥'],
                'åˆ': ['å­'], 'æœª': ['ä¸‘'], 'ç”³': ['å¯…'], 'é…‰': ['å¯'],
                'æˆŒ': ['è¾°'], 'äº¥': ['å·³'], 'å­': ['åˆ'], 'ä¸‘': ['æœª']
            },
            // å¤©å–œï¼ˆå¹´æ”¯æŸ¥åœ°æ”¯ï¼‰
            TianXi: {
                'å¯…': ['æˆŒ'], 'å¯': ['é…‰'], 'è¾°': ['ç”³'], 'å·³': ['æœª'],
                'åˆ': ['åˆ'], 'æœª': ['å·³'], 'ç”³': ['è¾°'], 'é…‰': ['å¯'],
                'æˆŒ': ['å¯…'], 'äº¥': ['ä¸‘'], 'å­': ['å­'], 'ä¸‘': ['äº¥']
            },
            // çº¢é¸¾ï¼ˆå¹´æ”¯æŸ¥åœ°æ”¯ï¼‰
            HongLuan: {
                'å¯…': ['å¯'], 'å¯': ['å¯…'], 'è¾°': ['ä¸‘'], 'å·³': ['å­'],
                'åˆ': ['äº¥'], 'æœª': ['æˆŒ'], 'ç”³': ['é…‰'], 'é…‰': ['ç”³'],
                'æˆŒ': ['æœª'], 'äº¥': ['åˆ'], 'å­': ['å·³'], 'ä¸‘': ['è¾°']
            },
            // ä¸§é—¨ï¼ˆå¹´æ”¯æŸ¥åœ°æ”¯ï¼‰
            SangMen: {
                'å¯…': ['å·³'], 'å¯': ['åˆ'], 'è¾°': ['æœª'], 'å·³': ['ç”³'],
                'åˆ': ['é…‰'], 'æœª': ['æˆŒ'], 'ç”³': ['äº¥'], 'é…‰': ['å­'],
                'æˆŒ': ['ä¸‘'], 'äº¥': ['å¯…'], 'å­': ['å¯'], 'ä¸‘': ['è¾°']
            },
            // åŠå®¢ï¼ˆå¹´æ”¯æŸ¥åœ°æ”¯ï¼‰
            DiaoKe: {
                'å¯…': ['ä¸‘'], 'å¯': ['å¯…'], 'è¾°': ['å¯'], 'å·³': ['è¾°'],
                'åˆ': ['å·³'], 'æœª': ['åˆ'], 'ç”³': ['æœª'], 'é…‰': ['ç”³'],
                'æˆŒ': ['é…‰'], 'äº¥': ['æˆŒ'], 'å­': ['äº¥'], 'ä¸‘': ['å­']
            },
            // å¤©å¾·åˆï¼ˆæœˆæ”¯æŸ¥å¤©å¹²ï¼‰
            TianDeHe: {
                'å¯…': ['å£¬'], 'å¯': ['åºš'], 'è¾°': ['ä¸™'], 'å·³': ['ä¹™'],
                'åˆ': ['ç”²'], 'æœª': ['ç™¸'], 'ç”³': ['ä¸'], 'é…‰': ['ä¸™'],
                'æˆŒ': ['è¾›'], 'äº¥': ['åºš'], 'å­': ['æˆŠ'], 'ä¸‘': ['ä¹™']
            },
            // æœˆå¾·åˆï¼ˆæœˆæ”¯æŸ¥å¤©å¹²ï¼‰
            YueDeHe: {
                'å¯…': ['è¾›'], 'å¯': ['å·±'], 'è¾°': ['ä¸™'], 'å·³': ['ä¹™'],
                'åˆ': ['è¾›'], 'æœª': ['å·±'], 'ç”³': ['ä¸™'], 'é…‰': ['ä¹™'],
                'æˆŒ': ['è¾›'], 'äº¥': ['å·±'], 'å­': ['ä¸™'], 'ä¸‘': ['ä¹™']
            },
            // å›½å°è´µäººï¼ˆæ—¥å¹²æŸ¥åœ°æ”¯ï¼‰
            GuoYin: {
                'ç”²': ['æˆŒ'], 'ä¹™': ['äº¥'], 'ä¸™': ['ä¸‘'], 'ä¸': ['ä¸‘'],
                'æˆŠ': ['ä¸‘'], 'å·±': ['ä¸‘'], 'åºš': ['è¾°'], 'è¾›': ['è¾°'],
                'å£¬': ['æœª'], 'ç™¸': ['æœª']
            },
            // å­¦å ‚ï¼ˆæ—¥å¹²æŸ¥åœ°æ”¯ï¼‰
            XueTang: {
                'ç”²': ['å·³'], 'ä¹™': ['åˆ'], 'ä¸™': ['ç”³'], 'ä¸': ['é…‰'],
                'æˆŠ': ['ç”³'], 'å·±': ['é…‰'], 'åºš': ['äº¥'], 'è¾›': ['å­'],
                'å£¬': ['å¯…'], 'ç™¸': ['å¯']
            },
            // å¤ªæè´µäººï¼ˆæ—¥å¹²æŸ¥åœ°æ”¯ï¼‰
            TaiJi: {
                'ç”²': ['å­','åˆ'], 'ä¹™': ['å­','åˆ'],
                'ä¸™': ['å¯','é…‰','å·³','äº¥'], 'ä¸': ['å¯','é…‰','å·³','äº¥'],
                'æˆŠ': ['è¾°','æˆŒ','ä¸‘','æœª'], 'å·±': ['è¾°','æˆŒ','ä¸‘','æœª'],
                'åºš': ['å¯…','äº¥','å·³','ç”³'], 'è¾›': ['å¯…','äº¥','å·³','ç”³'],
                'å£¬': ['å¯','é…‰'], 'ç™¸': ['å¯','é…‰']
            },
            // å¤©å¨è´µäººï¼ˆå¹´æ”¯æŸ¥åœ°æ”¯ï¼‰
            TianChu: {
                'å¯…': ['å·³'], 'å¯': ['åˆ'], 'è¾°': ['æœª'], 'å·³': ['ç”³'],
                'åˆ': ['é…‰'], 'æœª': ['æˆŒ'], 'ç”³': ['äº¥'], 'é…‰': ['å­'],
                'æˆŒ': ['ä¸‘'], 'äº¥': ['å¯…'], 'å­': ['å¯'], 'ä¸‘': ['è¾°']
            },
            // å¤©èµ¦ï¼ˆæœˆæ”¯å’Œæ—¥æ”¯ç»„åˆåˆ¤æ–­ï¼Œè¿™é‡Œç®€åŒ–å¤„ç†ï¼‰
            // æ˜¥å­£ï¼šæˆŠå¯…æ—¥ å¤å­£ï¼šç”²åˆæ—¥ ç§‹å­£ï¼šæˆŠç”³æ—¥ å†¬å­£ï¼šç”²å­æ—¥
            TianShe: {
                'å¯…': ['å¯…'], // æ˜¥æœˆè§å¯…
                'å¯': ['å¯…'],
                'è¾°': ['å¯…'],
                'å·³': ['åˆ'], // å¤æœˆè§åˆ
                'åˆ': ['åˆ'],
                'æœª': ['åˆ'],
                'ç”³': ['ç”³'], // ç§‹æœˆè§ç”³
                'é…‰': ['ç”³'],
                'æˆŒ': ['ç”³'],
                'äº¥': ['å­'], // å†¬æœˆè§å­
                'å­': ['å­'],
                'ä¸‘': ['å­']
            },
            // æŠ«éº»ï¼ˆå¹´æ”¯æŸ¥åœ°æ”¯ï¼‰
            PiMa: {
                'å¯…': ['äº¥'], 'å¯': ['å­'], 'è¾°': ['ä¸‘'], 'å·³': ['å¯…'],
                'åˆ': ['å¯'], 'æœª': ['è¾°'], 'ç”³': ['å·³'], 'é…‰': ['åˆ'],
                'æˆŒ': ['æœª'], 'äº¥': ['ç”³'], 'å­': ['é…‰'], 'ä¸‘': ['æˆŒ']
            }
        };

        function getWuxingClass(char) {
            return `wuxing-${WUXING_MAP[char] || 'åœŸ'}`;
        }

        // ============ åäºŒé•¿ç”Ÿæ•°æ® ============
        const CHANGSHENG_MAP = {
            'ç”²': {'äº¥':'é•¿ç”Ÿ','å­':'æ²æµ´','ä¸‘':'å† å¸¦','å¯…':'ä¸´å®˜','å¯':'å¸æ—º','è¾°':'è¡°','å·³':'ç—…','åˆ':'æ­»','æœª':'å¢“','ç”³':'ç»','é…‰':'èƒ','æˆŒ':'å…»'},
            'ä¹™': {'åˆ':'é•¿ç”Ÿ','å·³':'æ²æµ´','è¾°':'å† å¸¦','å¯':'ä¸´å®˜','å¯…':'å¸æ—º','ä¸‘':'è¡°','å­':'ç—…','äº¥':'æ­»','æˆŒ':'å¢“','é…‰':'ç»','ç”³':'èƒ','æœª':'å…»'},
            'ä¸™': {'å¯…':'é•¿ç”Ÿ','å¯':'æ²æµ´','è¾°':'å† å¸¦','å·³':'ä¸´å®˜','åˆ':'å¸æ—º','æœª':'è¡°','ç”³':'ç—…','é…‰':'æ­»','æˆŒ':'å¢“','äº¥':'ç»','å­':'èƒ','ä¸‘':'å…»'},
            'ä¸': {'é…‰':'é•¿ç”Ÿ','ç”³':'æ²æµ´','æœª':'å† å¸¦','åˆ':'ä¸´å®˜','å·³':'å¸æ—º','è¾°':'è¡°','å¯':'ç—…','å¯…':'æ­»','ä¸‘':'å¢“','å­':'ç»','äº¥':'èƒ','æˆŒ':'å…»'},
            'æˆŠ': {'å¯…':'é•¿ç”Ÿ','å¯':'æ²æµ´','è¾°':'å† å¸¦','å·³':'ä¸´å®˜','åˆ':'å¸æ—º','æœª':'è¡°','ç”³':'ç—…','é…‰':'æ­»','æˆŒ':'å¢“','äº¥':'ç»','å­':'èƒ','ä¸‘':'å…»'},
            'å·±': {'é…‰':'é•¿ç”Ÿ','ç”³':'æ²æµ´','æœª':'å† å¸¦','åˆ':'ä¸´å®˜','å·³':'å¸æ—º','è¾°':'è¡°','å¯':'ç—…','å¯…':'æ­»','ä¸‘':'å¢“','å­':'ç»','äº¥':'èƒ','æˆŒ':'å…»'},
            'åºš': {'å·³':'é•¿ç”Ÿ','åˆ':'æ²æµ´','æœª':'å† å¸¦','ç”³':'ä¸´å®˜','é…‰':'å¸æ—º','æˆŒ':'è¡°','äº¥':'ç—…','å­':'æ­»','ä¸‘':'å¢“','å¯…':'ç»','å¯':'èƒ','è¾°':'å…»'},
            'è¾›': {'å­':'é•¿ç”Ÿ','äº¥':'æ²æµ´','æˆŒ':'å† å¸¦','é…‰':'ä¸´å®˜','ç”³':'å¸æ—º','æœª':'è¡°','åˆ':'ç—…','å·³':'æ­»','è¾°':'å¢“','å¯':'ç»','å¯…':'èƒ','ä¸‘':'å…»'},
            'å£¬': {'ç”³':'é•¿ç”Ÿ','é…‰':'æ²æµ´','æˆŒ':'å† å¸¦','äº¥':'ä¸´å®˜','å­':'å¸æ—º','ä¸‘':'è¡°','å¯…':'ç—…','å¯':'æ­»','è¾°':'å¢“','å·³':'ç»','åˆ':'èƒ','æœª':'å…»'},
            'ç™¸': {'å¯':'é•¿ç”Ÿ','å¯…':'æ²æµ´','ä¸‘':'å† å¸¦','å­':'ä¸´å®˜','äº¥':'å¸æ—º','æˆŒ':'è¡°','é…‰':'ç—…','ç”³':'æ­»','æœª':'å¢“','åˆ':'ç»','å·³':'èƒ','è¾°':'å…»'}
        };

        function getChangSheng(gan, zhi) {
            return CHANGSHENG_MAP[gan] ? CHANGSHENG_MAP[gan][zhi] || '-' : '-';
        }

        // ============ è®¡ç®—ç¥ç… ============
        function calculateShenSha(dayGan, dayZhi, yearZhi, monthZhi, allZhi, allGan, yearGan, monthGan, timeGan, allZhiList) {
            let shenshaList = [];
            
            // å¤©ä¹™è´µäººï¼ˆå¹´å¹²ã€æœˆå¹²ã€æ—¥å¹²ã€æ—¶å¹²åˆ†åˆ«æŸ¥æ‰€æœ‰åœ°æ”¯ï¼‰
            if (yearGan && allZhiList) {
                // ç”¨å››æŸ±çš„æ¯ä¸ªå¤©å¹²å»æŸ¥å››æŸ±çš„æ‰€æœ‰åœ°æ”¯
                const allGanList = [yearGan, monthGan, dayGan, timeGan].filter(g => g);
                allGanList.forEach(gan => {
                    if (SHENSHA.TianYi[gan]) {
                        allZhiList.forEach(zhi => {
                            if (SHENSHA.TianYi[gan].includes(zhi) && !shenshaList.includes('å¤©ä¹™è´µäºº')) {
                                shenshaList.push('å¤©ä¹™è´µäºº');
                            }
                        });
                    }
                });
            } else {
                // å…¼å®¹æ—§çš„è°ƒç”¨æ–¹å¼ï¼ˆåªç”¨æ—¥å¹²æŸ¥å½“å‰åœ°æ”¯ï¼Œç”¨äºæµæ—¥è®¡ç®—ï¼‰
                if (SHENSHA.TianYi[dayGan] && SHENSHA.TianYi[dayGan].includes(allZhi)) {
                    shenshaList.push('å¤©ä¹™è´µäºº');
                }
            }
            
            // æ–‡æ˜Œè´µäººï¼ˆå¹´å¹²ã€æœˆå¹²ã€æ—¥å¹²ã€æ—¶å¹²åˆ†åˆ«æŸ¥æ‰€æœ‰åœ°æ”¯ï¼‰
            // è¿™æ ·å¯ä»¥æ‰¾å‡ºæ‰€æœ‰å¯èƒ½çš„æ–‡æ˜Œè´µäºº
            if (yearGan && allZhiList) {
                // ç”¨å››æŸ±çš„æ¯ä¸ªå¤©å¹²å»æŸ¥å››æŸ±çš„æ‰€æœ‰åœ°æ”¯
                const allGanList = [yearGan, monthGan, dayGan, timeGan].filter(g => g);
                const wenChangFound = [];
                allGanList.forEach(gan => {
                    if (SHENSHA.WenChang[gan]) {
                        allZhiList.forEach(zhi => {
                            if (SHENSHA.WenChang[gan].includes(zhi)) {
                                wenChangFound.push(`${gan}è§${zhi}`);
                                if (!shenshaList.includes('æ–‡æ˜Œè´µäºº')) {
                                    shenshaList.push('æ–‡æ˜Œè´µäºº');
                                }
                            }
                        });
                    }
                });
                if (wenChangFound.length > 0) {
                    console.log('æ‰¾åˆ°æ–‡æ˜Œè´µäºº:', wenChangFound);
                }
            } else {
                // å…¼å®¹æ—§çš„è°ƒç”¨æ–¹å¼ï¼ˆåªç”¨æ—¥å¹²æŸ¥å½“å‰åœ°æ”¯ï¼Œç”¨äºæµæ—¥è®¡ç®—ï¼‰
                if (SHENSHA.WenChang[dayGan] && SHENSHA.WenChang[dayGan].includes(allZhi)) {
                    shenshaList.push('æ–‡æ˜Œè´µäºº');
                }
            }
            
            // å¤©å¾·è´µäººï¼ˆæœˆæ”¯æŸ¥å¤©å¹²ï¼‰
            if (SHENSHA.TianDe[monthZhi] && allGan && SHENSHA.TianDe[monthZhi].includes(allGan)) {
                shenshaList.push('å¤©å¾·');
            }
            
            // æœˆå¾·è´µäººï¼ˆæœˆæ”¯æŸ¥å¤©å¹²ï¼‰
            if (SHENSHA.YueDe[monthZhi] && allGan && SHENSHA.YueDe[monthZhi].includes(allGan)) {
                shenshaList.push('æœˆå¾·');
            }
            
            // å¤©å¾·åˆï¼ˆæœˆæ”¯æŸ¥å¤©å¹²ï¼‰
            if (SHENSHA.TianDeHe[monthZhi] && allGan && SHENSHA.TianDeHe[monthZhi].includes(allGan)) {
                shenshaList.push('å¤©å¾·åˆ');
            }
            
            // æœˆå¾·åˆï¼ˆæœˆæ”¯æŸ¥å¤©å¹²ï¼‰
            if (SHENSHA.YueDeHe[monthZhi] && allGan && SHENSHA.YueDeHe[monthZhi].includes(allGan)) {
                shenshaList.push('æœˆå¾·åˆ');
            }
            
            // çº¢è‰³
            if (SHENSHA.HongYan[dayGan] && SHENSHA.HongYan[dayGan].includes(allZhi)) {
                shenshaList.push('çº¢è‰³');
            }
            
            // æ¡ƒèŠ±ï¼ˆä»¥æ—¥æ”¯æŸ¥ï¼‰
            if (SHENSHA.TaoHua[dayZhi] && SHENSHA.TaoHua[dayZhi].includes(allZhi)) {
                shenshaList.push('æ¡ƒèŠ±');
            }
            
            // å’¸æ± ï¼ˆä»¥æ—¥æ”¯æŸ¥ï¼Œå®é™…ä¸Šå°±æ˜¯æ¡ƒèŠ±çš„åˆ«åï¼Œè¿™é‡Œé¿å…é‡å¤ï¼‰
            if (SHENSHA.XianChi[dayZhi] && SHENSHA.XianChi[dayZhi].includes(allZhi) && !shenshaList.includes('æ¡ƒèŠ±')) {
                shenshaList.push('å’¸æ± ');
            }
            
            // é©¿é©¬ï¼ˆä»¥æ—¥æ”¯æŸ¥ï¼‰
            if (SHENSHA.YiMa[dayZhi] && SHENSHA.YiMa[dayZhi].includes(allZhi)) {
                shenshaList.push('é©¿é©¬');
            }
            
            // åç›–ï¼ˆä»¥æ—¥æ”¯æŸ¥ï¼‰
            if (SHENSHA.HuaGai[dayZhi] && SHENSHA.HuaGai[dayZhi].includes(allZhi)) {
                shenshaList.push('åç›–');
            }
            
            // å°†æ˜Ÿï¼ˆä»¥æ—¥æ”¯æŸ¥ï¼‰
            if (SHENSHA.JiangXing[dayZhi] && SHENSHA.JiangXing[dayZhi].includes(allZhi)) {
                shenshaList.push('å°†æ˜Ÿ');
            }
            
            // é‡‘èˆ†ï¼ˆä»¥æ—¥æ”¯æŸ¥ï¼‰
            if (SHENSHA.JinYu[dayZhi] && SHENSHA.JinYu[dayZhi].includes(allZhi)) {
                shenshaList.push('é‡‘èˆ†');
            }
            
            // å­¤è¾°ï¼ˆä»¥å¹´æ”¯æŸ¥ï¼‰
            if (SHENSHA.GuChen[yearZhi] && SHENSHA.GuChen[yearZhi].includes(allZhi)) {
                shenshaList.push('å­¤è¾°');
            }
            
            // å¯¡å®¿ï¼ˆä»¥å¹´æ”¯æŸ¥ï¼‰
            if (SHENSHA.GuaSu[yearZhi] && SHENSHA.GuaSu[yearZhi].includes(allZhi)) {
                shenshaList.push('å¯¡å®¿');
            }
            
            // ç¾Šåˆƒ
            if (SHENSHA.YangRen[dayGan] && SHENSHA.YangRen[dayGan].includes(allZhi)) {
                shenshaList.push('ç¾Šåˆƒ');
            }
            
            // ç¦„ç¥
            if (SHENSHA.LuShen[dayGan] && SHENSHA.LuShen[dayGan].includes(allZhi)) {
                shenshaList.push('ç¦„ç¥');
            }
            
            // åŠ«ç…ï¼ˆä»¥æ—¥æ”¯æŸ¥ï¼‰
            if (SHENSHA.JieSha[dayZhi] && SHENSHA.JieSha[dayZhi].includes(allZhi)) {
                shenshaList.push('åŠ«ç…');
            }
            
            // ç¾ç…ï¼ˆä»¥æ—¥æ”¯æŸ¥ï¼‰
            if (SHENSHA.ZaiSha[dayZhi] && SHENSHA.ZaiSha[dayZhi].includes(allZhi)) {
                shenshaList.push('ç¾ç…');
            }
            
            // äº¡ç¥ï¼ˆä»¥æ—¥æ”¯æŸ¥ï¼‰
            if (SHENSHA.WangShen[dayZhi] && SHENSHA.WangShen[dayZhi].includes(allZhi)) {
                shenshaList.push('äº¡ç¥');
            }
            
            // å¤©ç½—åœ°ç½‘
            if (SHENSHA.TianLuo.includes(allZhi)) {
                shenshaList.push('å¤©ç½—');
            }
            if (SHENSHA.DiWang.includes(allZhi)) {
                shenshaList.push('åœ°ç½‘');
            }
            
            // å…ƒè¾°ï¼ˆä»¥å¹´æ”¯æŸ¥ï¼‰
            if (SHENSHA.YuanChen[yearZhi] && SHENSHA.YuanChen[yearZhi].includes(allZhi)) {
                shenshaList.push('å…ƒè¾°');
            }
            
            // ç™½è™ï¼ˆä»¥å¹´æ”¯æŸ¥ï¼‰
            if (SHENSHA.BaiHu[yearZhi] && SHENSHA.BaiHu[yearZhi].includes(allZhi)) {
                shenshaList.push('ç™½è™');
            }
            
            // å¤©å–œï¼ˆä»¥å¹´æ”¯æŸ¥ï¼‰
            if (SHENSHA.TianXi[yearZhi] && SHENSHA.TianXi[yearZhi].includes(allZhi)) {
                shenshaList.push('å¤©å–œ');
            }
            
            // çº¢é¸¾ï¼ˆä»¥å¹´æ”¯æŸ¥ï¼‰
            if (SHENSHA.HongLuan[yearZhi] && SHENSHA.HongLuan[yearZhi].includes(allZhi)) {
                shenshaList.push('çº¢é¸¾');
            }
            
            // ä¸§é—¨ï¼ˆä»¥å¹´æ”¯æŸ¥ï¼‰
            if (SHENSHA.SangMen[yearZhi] && SHENSHA.SangMen[yearZhi].includes(allZhi)) {
                shenshaList.push('ä¸§é—¨');
            }
            
            // åŠå®¢ï¼ˆä»¥å¹´æ”¯æŸ¥ï¼‰
            if (SHENSHA.DiaoKe[yearZhi] && SHENSHA.DiaoKe[yearZhi].includes(allZhi)) {
                shenshaList.push('åŠå®¢');
            }
            
            // æŠ«éº»ï¼ˆä»¥å¹´æ”¯æŸ¥ï¼‰
            if (SHENSHA.PiMa[yearZhi] && SHENSHA.PiMa[yearZhi].includes(allZhi)) {
                shenshaList.push('æŠ«éº»');
            }
            
            // å›½å°è´µäººï¼ˆæ—¥å¹²æŸ¥åœ°æ”¯ï¼‰
            if (SHENSHA.GuoYin[dayGan] && SHENSHA.GuoYin[dayGan].includes(allZhi)) {
                shenshaList.push('å›½å°è´µäºº');
            }
            
            // å­¦å ‚ï¼ˆæ—¥å¹²æŸ¥åœ°æ”¯ï¼‰- ä¸æ–‡æ˜Œç›¸åŒï¼Œé¿å…é‡å¤
            if (SHENSHA.XueTang[dayGan] && SHENSHA.XueTang[dayGan].includes(allZhi) && !shenshaList.includes('æ–‡æ˜Œ')) {
                shenshaList.push('å­¦å ‚');
            }
            
            // å¤ªæè´µäººï¼ˆæ—¥å¹²æŸ¥åœ°æ”¯ï¼‰
            if (SHENSHA.TaiJi[dayGan] && SHENSHA.TaiJi[dayGan].includes(allZhi)) {
                shenshaList.push('å¤ªæè´µäºº');
            }
            
            // å¤©å¨è´µäººï¼ˆå¹´æ”¯æŸ¥åœ°æ”¯ï¼‰
            if (SHENSHA.TianChu[yearZhi] && SHENSHA.TianChu[yearZhi].includes(allZhi)) {
                shenshaList.push('å¤©å¨è´µäºº');
            }
            
            // å¤©èµ¦ï¼ˆæœˆæ”¯æŸ¥æ—¥æ”¯ï¼Œéœ€è¦é…åˆå¤©å¹²ï¼‰
            if (SHENSHA.TianShe[monthZhi] && SHENSHA.TianShe[monthZhi].includes(allZhi)) {
                // å¤©èµ¦éœ€è¦ç‰¹å®šçš„å¤©å¹²åœ°æ”¯ç»„åˆ
                const validCombos = {
                    'å¯…': 'E', 'å¯': 'E', 'è¾°': 'E', // æ˜¥æœˆæˆŠå¯…
                    'å·³': 'A', 'åˆ': 'A', 'æœª': 'A', // å¤æœˆç”²åˆ
                    'ç”³': 'E', 'é…‰': 'E', 'æˆŒ': 'E', // ç§‹æœˆæˆŠç”³
                    'äº¥': 'A', 'å­': 'A', 'ä¸‘': 'A'  // å†¬æœˆç”²å­
                };
                const ganMap = {'ç”²': 'A', 'ä¹™': 'B', 'ä¸™': 'C', 'ä¸': 'D', 'æˆŠ': 'E', 'å·±': 'F', 'åºš': 'G', 'è¾›': 'H', 'å£¬': 'I', 'ç™¸': 'J'};
                if (allGan && ganMap[allGan] === validCombos[monthZhi]) {
                    shenshaList.push('å¤©èµ¦');
                }
            }
            
            return shenshaList;
        }

        // ============ æ£€æŸ¥äº¤äº’å…³ç³» ============
        function checkInteractions(dayChar, natalChartChars, type) {
            let results = [];
            const mapKeys = Object.keys(natalChartChars);
            
            mapKeys.forEach(pillarKey => {
                const natalChar = natalChartChars[pillarKey];
                const pillarName = {'Y':'å¹´','M':'æœˆ','D':'æ—¥','T':'æ—¶'}[pillarKey];
                
                if (type === 'Gan') {
                    // å¤©å¹²åˆ
                    if (RELATIONS.GanHe[dayChar] === natalChar) {
                        results.push(`<span class="interaction-tag tag-he">åˆ${pillarName}å¹²</span>`);
                    }
                    // å¤©å¹²å†²
                    if (RELATIONS.GanChong[dayChar] === natalChar) {
                        results.push(`<span class="interaction-tag tag-chong">å†²${pillarName}å¹²</span>`);
                    }
                } else {
                    // åœ°æ”¯å…­åˆ
                    if (RELATIONS.ZhiLiuHe[dayChar] === natalChar) {
                        results.push(`<span class="interaction-tag tag-he">å…­åˆ${pillarName}æ”¯</span>`);
                    }
                    // åœ°æ”¯å†²
                    if (RELATIONS.ZhiChong[dayChar] === natalChar) {
                        results.push(`<span class="interaction-tag tag-chong">å†²${pillarName}æ”¯</span>`);
                    }
                    // åœ°æ”¯åˆ‘
                    if (RELATIONS.ZhiXing[dayChar] && RELATIONS.ZhiXing[dayChar].includes(natalChar)) {
                        results.push(`<span class="interaction-tag tag-xing">åˆ‘${pillarName}æ”¯</span>`);
                    }
                    // åœ°æ”¯å®³
                    if (RELATIONS.ZhiHai[dayChar] === natalChar) {
                        results.push(`<span class="interaction-tag tag-hai">å®³${pillarName}æ”¯</span>`);
                    }
                    // åœ°æ”¯ç ´
                    if (RELATIONS.ZhiPo[dayChar] === natalChar) {
                        results.push(`<span class="interaction-tag tag-po">ç ´${pillarName}æ”¯</span>`);
                    }
                }
            });
            
            return results.join(' ');
        }

        // ============ ä¸»è®¡ç®—å‡½æ•° ============
        function calculate() {
            const birthInput = document.getElementById('birthDate').value;
            const targetYear = parseInt(document.getElementById('targetYear').value);
            const targetMonth = parseInt(document.getElementById('targetMonth').value);
            const userName = document.getElementById('userName').value || 'æœªå¡«å†™';
            const userGender = parseInt(document.getElementById('userGender').value);

            if (!birthInput) {
                alert("è¯·è¾“å…¥å‡ºç”Ÿæ—¥æœŸ");
                return;
            }

            const birthDate = new Date(birthInput);
            
            // å®ä¾‹åŒ– Solar å¯¹è±¡
            const solarBirth = Solar.fromYmdHms(
                birthDate.getFullYear(), 
                birthDate.getMonth() + 1, 
                birthDate.getDate(), 
                birthDate.getHours(), 
                birthDate.getMinutes(), 
                0
            );

            // è½¬å†œå†å¹¶è·å–å…«å­—
            const lunarBirth = solarBirth.getLunar();
            const bazi = lunarBirth.getEightChar();
            
            try {
                // 0. æ¸²æŸ“å…«å­—æ’ç›˜ç»“æœ
                renderBaziResult(bazi, lunarBirth, solarBirth, userName, userGender);
            } catch (e) {
                console.error('æ¸²æŸ“å…«å­—æ’ç›˜ç»“æœå‡ºé”™:', e);
            }
            
            try {
                // 1. æ¸²æŸ“åŸå±€
                renderNatalChart(bazi, lunarBirth, userGender, birthDate);
            } catch (e) {
                console.error('æ¸²æŸ“åŸå±€å‡ºé”™:', e);
            }
            
            try {
                // 2. æ¸²æŸ“æµæ—¥
                renderDailyCalendar(bazi, targetYear, targetMonth);
            } catch (e) {
                console.error('æ¸²æŸ“æµæ—¥å‡ºé”™:', e);
                alert('æ¸²æŸ“æµæ—¥å‡ºé”™ï¼š' + e.message + '\nè¯·æŸ¥çœ‹æ§åˆ¶å°è·å–è¯¦ç»†ä¿¡æ¯');
            }
        }

        // ============ åç¥æ˜ å°„ ============
        const SHISHEN_MAP = {
            'ç”²': {'ç”²': 'æ¯”è‚©', 'ä¹™': 'åŠ«è´¢', 'ä¸™': 'é£Ÿç¥', 'ä¸': 'ä¼¤å®˜', 'æˆŠ': 'åè´¢', 'å·±': 'æ­£è´¢', 'åºš': 'åå®˜', 'è¾›': 'æ­£å®˜', 'å£¬': 'åå°', 'ç™¸': 'æ­£å°'},
            'ä¹™': {'ç”²': 'åŠ«è´¢', 'ä¹™': 'æ¯”è‚©', 'ä¸™': 'ä¼¤å®˜', 'ä¸': 'é£Ÿç¥', 'æˆŠ': 'æ­£è´¢', 'å·±': 'åè´¢', 'åºš': 'æ­£å®˜', 'è¾›': 'åå®˜', 'å£¬': 'æ­£å°', 'ç™¸': 'åå°'},
            'ä¸™': {'ç”²': 'åå°', 'ä¹™': 'æ­£å°', 'ä¸™': 'æ¯”è‚©', 'ä¸': 'åŠ«è´¢', 'æˆŠ': 'é£Ÿç¥', 'å·±': 'ä¼¤å®˜', 'åºš': 'åè´¢', 'è¾›': 'æ­£è´¢', 'å£¬': 'åå®˜', 'ç™¸': 'æ­£å®˜'},
            'ä¸': {'ç”²': 'æ­£å°', 'ä¹™': 'åå°', 'ä¸™': 'åŠ«è´¢', 'ä¸': 'æ¯”è‚©', 'æˆŠ': 'ä¼¤å®˜', 'å·±': 'é£Ÿç¥', 'åºš': 'æ­£è´¢', 'è¾›': 'åè´¢', 'å£¬': 'æ­£å®˜', 'ç™¸': 'åå®˜'},
            'æˆŠ': {'ç”²': 'åå®˜', 'ä¹™': 'æ­£å®˜', 'ä¸™': 'åå°', 'ä¸': 'æ­£å°', 'æˆŠ': 'æ¯”è‚©', 'å·±': 'åŠ«è´¢', 'åºš': 'é£Ÿç¥', 'è¾›': 'ä¼¤å®˜', 'å£¬': 'åè´¢', 'ç™¸': 'æ­£è´¢'},
            'å·±': {'ç”²': 'æ­£å®˜', 'ä¹™': 'åå®˜', 'ä¸™': 'æ­£å°', 'ä¸': 'åå°', 'æˆŠ': 'åŠ«è´¢', 'å·±': 'æ¯”è‚©', 'åºš': 'ä¼¤å®˜', 'è¾›': 'é£Ÿç¥', 'å£¬': 'æ­£è´¢', 'ç™¸': 'åè´¢'},
            'åºš': {'ç”²': 'åè´¢', 'ä¹™': 'æ­£è´¢', 'ä¸™': 'åå®˜', 'ä¸': 'æ­£å®˜', 'æˆŠ': 'åå°', 'å·±': 'æ­£å°', 'åºš': 'æ¯”è‚©', 'è¾›': 'åŠ«è´¢', 'å£¬': 'é£Ÿç¥', 'ç™¸': 'ä¼¤å®˜'},
            'è¾›': {'ç”²': 'æ­£è´¢', 'ä¹™': 'åè´¢', 'ä¸™': 'æ­£å®˜', 'ä¸': 'åå®˜', 'æˆŠ': 'æ­£å°', 'å·±': 'åå°', 'åºš': 'åŠ«è´¢', 'è¾›': 'æ¯”è‚©', 'å£¬': 'ä¼¤å®˜', 'ç™¸': 'é£Ÿç¥'},
            'å£¬': {'ç”²': 'é£Ÿç¥', 'ä¹™': 'ä¼¤å®˜', 'ä¸™': 'åè´¢', 'ä¸': 'æ­£è´¢', 'æˆŠ': 'åå®˜', 'å·±': 'æ­£å®˜', 'åºš': 'åå°', 'è¾›': 'æ­£å°', 'å£¬': 'æ¯”è‚©', 'ç™¸': 'åŠ«è´¢'},
            'ç™¸': {'ç”²': 'ä¼¤å®˜', 'ä¹™': 'é£Ÿç¥', 'ä¸™': 'æ­£è´¢', 'ä¸': 'åè´¢', 'æˆŠ': 'æ­£å®˜', 'å·±': 'åå®˜', 'åºš': 'æ­£å°', 'è¾›': 'åå°', 'å£¬': 'åŠ«è´¢', 'ç™¸': 'æ¯”è‚©'}
        };

        // è·å–åœ°æ”¯è—å¹²
        const CANGAN_MAP = {
            'å­': ['ç™¸'],
            'ä¸‘': ['å·±', 'ç™¸', 'è¾›'],
            'å¯…': ['ç”²', 'ä¸™', 'æˆŠ'],
            'å¯': ['ä¹™'],
            'è¾°': ['æˆŠ', 'ä¹™', 'ç™¸'],
            'å·³': ['ä¸™', 'åºš', 'æˆŠ'],
            'åˆ': ['ä¸', 'å·±'],
            'æœª': ['å·±', 'ä¸', 'ä¹™'],
            'ç”³': ['åºš', 'å£¬', 'æˆŠ'],
            'é…‰': ['è¾›'],
            'æˆŒ': ['æˆŠ', 'è¾›', 'ä¸'],
            'äº¥': ['å£¬', 'ç”²']
        };

        // çº³éŸ³
        const NAYIN_MAP = {
            'ç”²å­': 'æµ·ä¸­é‡‘', 'ä¹™ä¸‘': 'æµ·ä¸­é‡‘', 'ä¸™å¯…': 'ç‚‰ä¸­ç«', 'ä¸å¯': 'ç‚‰ä¸­ç«',
            'æˆŠè¾°': 'å¤§æ—æœ¨', 'å·±å·³': 'å¤§æ—æœ¨', 'åºšåˆ': 'è·¯æ—åœŸ', 'è¾›æœª': 'è·¯æ—åœŸ',
            'å£¬ç”³': 'å‰‘é”‹é‡‘', 'ç™¸é…‰': 'å‰‘é”‹é‡‘', 'ç”²æˆŒ': 'å±±å¤´ç«', 'ä¹™äº¥': 'å±±å¤´ç«',
            'ä¸™å­': 'æ¶§ä¸‹æ°´', 'ä¸ä¸‘': 'æ¶§ä¸‹æ°´', 'æˆŠå¯…': 'åŸå¤´åœŸ', 'å·±å¯': 'åŸå¤´åœŸ',
            'åºšè¾°': 'ç™½èœ¡é‡‘', 'è¾›å·³': 'ç™½èœ¡é‡‘', 'å£¬åˆ': 'æ¨æŸ³æœ¨', 'ç™¸æœª': 'æ¨æŸ³æœ¨',
            'ç”²ç”³': 'æ³‰ä¸­æ°´', 'ä¹™é…‰': 'æ³‰ä¸­æ°´', 'ä¸™æˆŒ': 'å±‹ä¸ŠåœŸ', 'ä¸äº¥': 'å±‹ä¸ŠåœŸ',
            'æˆŠå­': 'éœ¹é›³ç«', 'å·±ä¸‘': 'éœ¹é›³ç«', 'åºšå¯…': 'æ¾æŸæœ¨', 'è¾›å¯': 'æ¾æŸæœ¨',
            'å£¬è¾°': 'é•¿æµæ°´', 'ç™¸å·³': 'é•¿æµæ°´', 'ç”²åˆ': 'ç ‚çŸ³é‡‘', 'ä¹™æœª': 'ç ‚çŸ³é‡‘',
            'ä¸™ç”³': 'å±±ä¸‹ç«', 'ä¸é…‰': 'å±±ä¸‹ç«', 'æˆŠæˆŒ': 'å¹³åœ°æœ¨', 'å·±äº¥': 'å¹³åœ°æœ¨',
            'åºšå­': 'å£ä¸ŠåœŸ', 'è¾›ä¸‘': 'å£ä¸ŠåœŸ', 'å£¬å¯…': 'é‡‘ç®”é‡‘', 'ç™¸å¯': 'é‡‘ç®”é‡‘',
            'ç”²è¾°': 'è¦†ç¯ç«', 'ä¹™å·³': 'è¦†ç¯ç«', 'ä¸™åˆ': 'å¤©æ²³æ°´', 'ä¸æœª': 'å¤©æ²³æ°´',
            'æˆŠç”³': 'å¤§é©¿åœŸ', 'å·±é…‰': 'å¤§é©¿åœŸ', 'åºšæˆŒ': 'é’—é’é‡‘', 'è¾›äº¥': 'é’—é’é‡‘',
            'å£¬å­': 'æ¡‘æŸ˜æœ¨', 'ç™¸ä¸‘': 'æ¡‘æŸ˜æœ¨', 'ç”²å¯…': 'å¤§æºªæ°´', 'ä¹™å¯': 'å¤§æºªæ°´',
            'ä¸™è¾°': 'æ²™ä¸­åœŸ', 'ä¸å·³': 'æ²™ä¸­åœŸ', 'æˆŠåˆ': 'å¤©ä¸Šç«', 'å·±æœª': 'å¤©ä¸Šç«',
            'åºšç”³': 'çŸ³æ¦´æœ¨', 'è¾›é…‰': 'çŸ³æ¦´æœ¨', 'å£¬æˆŒ': 'å¤§æµ·æ°´', 'ç™¸äº¥': 'å¤§æµ·æ°´'
        };

        function getShiShen(dayGan, targetGan) {
            return SHISHEN_MAP[dayGan] ? SHISHEN_MAP[dayGan][targetGan] : '';
        }

        function getCangGan(zhi) {
            return CANGAN_MAP[zhi] || [];
        }

        function getNaYin(ganZhi) {
            return NAYIN_MAP[ganZhi] || '';
        }

        // ============ ç”Ÿæˆå‘½ç›˜ç»¼åˆåˆ†æ ============
        function generateBaziSummary(bazi, wuxingCount, shenshaList, userGender, riYuanStrength, totalScore, yuelingScore, dizhiScore, tianganScore, yuelingStatus) {
            let html = '';
            
            // 1. äº”è¡Œåˆ†æ
            const wuxingEntries = Object.entries(wuxingCount);
            const maxWuxing = wuxingEntries.reduce((max, curr) => curr[1] > max[1] ? curr : max);
            const minWuxing = wuxingEntries.filter(e => e[1] === 0);
            const weakWuxing = wuxingEntries.filter(e => e[1] === 1);
            
            html += '<p><strong>ã€äº”è¡Œåˆ†æã€‘</strong>';
            if (maxWuxing[1] >= 3) {
                html += `å‘½å±€<span class="font-semibold text-${maxWuxing[0] === 'é‡‘' ? 'yellow' : maxWuxing[0] === 'æœ¨' ? 'green' : maxWuxing[0] === 'æ°´' ? 'blue' : maxWuxing[0] === 'ç«' ? 'red' : 'yellow'}-700">${maxWuxing[0]}</span>è¡Œè¾ƒæ—ºï¼ˆ${maxWuxing[1]}ä¸ªï¼‰ã€‚`;
            }
            
            if (minWuxing.length > 0) {
                html += `äº”è¡Œç¼º<span class="font-semibold text-red-600">${minWuxing.map(e => e[0]).join('ã€')}</span>ã€‚`;
            } else if (weakWuxing.length > 0) {
                html += `äº”è¡Œ${weakWuxing.map(e => e[0]).join('ã€')}è¾ƒå¼±ã€‚`;
            } else {
                html += 'äº”è¡Œè¾ƒä¸ºé½å…¨å¹³è¡¡ã€‚';
            }
            html += '</p>';
            
            // 2. æ—¥å…ƒå¼ºå¼±åˆ†æï¼ˆå¼•ç”¨ä¸Šé¢è®¡ç®—å‡ºçš„ç»“æœï¼‰
            const dayGan = bazi.getDayGan();
            const dayWuxing = WUXING_MAP[dayGan];
            const monthZhi = bazi.getMonthZhi();
            
            // è¿™é‡Œä½¿ç”¨å‰é¢å·²ç»è®¡ç®—å¥½çš„ riYuanStrength å’Œ yuelingStatus
            html += `<p><strong>ã€æ—¥å…ƒåˆ†æã€‘</strong>æ—¥å…ƒ<span class="font-bold text-lg">${dayGan}</span>${dayWuxing}ï¼Œç”Ÿäº${monthZhi}æœˆï¼ˆ${yuelingStatus}ï¼‰ï¼Œæ—¥ä¸»<span class="font-semibold ${riYuanStrength === 'èº«æ—º' ? 'text-green-600' : riYuanStrength === 'èº«å¼±' ? 'text-orange-600' : 'text-blue-600'}">${riYuanStrength}</span>ã€‚ç»¼åˆå¾—åˆ†${totalScore.toFixed(1)}åˆ†ï¼ˆæœˆä»¤${yuelingScore}åˆ†+åœ°æ”¯${dizhiScore.toFixed(1)}åˆ†+å¤©å¹²${tianganScore}åˆ†ï¼‰ã€‚</p>`;
            
            // 3. ç¥ç…å‰å‡¶åˆ†æ
            const jiShenSha = ['å¤©ä¹™è´µäºº', 'å¤©å¾·è´µäºº', 'æœˆå¾·è´µäºº', 'æ–‡æ˜Œè´µäºº', 'å¤ªæè´µäºº', 'å›½å°è´µäºº', 'ç¦„ç¥', 'å°†æ˜Ÿ', 'å¤©å¨è´µäºº', 'é‡‘èˆ†', 'çº¢é¸¾', 'å¤©å–œ'];
            const xiongShenSha = ['åŠ«ç…', 'ç¾ç…', 'äº¡ç¥', 'ç¾Šåˆƒ', 'å…ƒè¾°', 'ç™½è™', 'ä¸§é—¨', 'åŠå®¢', 'æŠ«éº»', 'å­¤è¾°', 'å¯¡å®¿'];
            
            const jiList = shenshaList.filter(s => jiShenSha.includes(s));
            const xiongList = shenshaList.filter(s => xiongShenSha.includes(s));
            
            html += '<p><strong>ã€ç¥ç…åˆ†æã€‘</strong>';
            if (jiList.length > 0) {
                html += `å‘½å¸¦å‰ç¥ï¼š<span class="text-green-600 font-medium">${jiList.join('ã€')}</span>ã€‚`;
            }
            if (xiongList.length > 0) {
                html += `å‘½å¸¦å‡¶ç…ï¼š<span class="text-red-600 font-medium">${xiongList.join('ã€')}</span>ã€‚`;
            }
            
            if (jiList.length > xiongList.length) {
                html += 'å‰æ˜Ÿè¾ƒå¤šï¼Œè´µäººç›¸åŠ©ï¼Œå¤šé€¢åŒ–å‰ã€‚';
            } else if (xiongList.length > jiList.length) {
                html += 'å‡¶ç…è¾ƒå¤šï¼Œäººç”Ÿå¤šæ³¢æŠ˜ï¼Œéœ€è°¨æ…è¡Œäº‹ã€‚';
            } else {
                html += 'å‰å‡¶å‚åŠï¼Œéœ€æŠŠæ¡æœºé‡ã€‚';
            }
            html += '</p>';
            
            // 4. ç‰¹æ®Šç¥ç…æç¤º
            let specialTips = [];
            if (shenshaList.includes('å¤©ä¹™è´µäºº')) {
                specialTips.push('å¤©ä¹™è´µäººæŠ¤ä½‘ï¼Œé‡éš¾å‘ˆç¥¥');
            }
            if (shenshaList.includes('æ–‡æ˜Œè´µäºº') || shenshaList.includes('å­¦å ‚')) {
                specialTips.push('æ–‡æ˜Œå­¦å ‚åŠ èº«ï¼Œèªæ˜å¥½å­¦ï¼Œåˆ©æ–‡åŒ–äº‹ä¸š');
            }
            if (shenshaList.includes('æ¡ƒèŠ±') || shenshaList.includes('çº¢è‰³')) {
                specialTips.push('å‘½å¸¦æ¡ƒèŠ±ï¼Œå¼‚æ€§ç¼˜ä½³');
            }
            if (shenshaList.includes('é©¿é©¬')) {
                specialTips.push('é©¿é©¬æ˜ŸåŠ¨ï¼Œé€‚åˆå¤–å‡ºå‘å±•');
            }
            if (shenshaList.includes('åç›–')) {
                specialTips.push('åç›–ä¸´èº«ï¼Œæœ‰è‰ºæœ¯å¤©èµ‹');
            }
            if (shenshaList.includes('ç¾Šåˆƒ')) {
                specialTips.push('ç¾Šåˆƒä¹‹å‘½ï¼Œæ€§æ ¼åˆšå¼º');
            }
            if (shenshaList.includes('å­¤è¾°') || shenshaList.includes('å¯¡å®¿')) {
                specialTips.push('å‘½å¸¦å­¤å¯¡ï¼Œæ€§æ ¼ç‹¬ç«‹');
            }
            
            if (specialTips.length > 0) {
                html += `<p><strong>ã€ç‰¹åˆ«æç¤ºã€‘</strong>${specialTips.join('ï¼›')}ã€‚</p>`;
            }
            
            // 5. æ€§æ ¼ç‰¹å¾
            const genderText = userGender === 1 ? 'ç”·å‘½' : 'å¥³å‘½';
            const xinggeMap = {
                'æœ¨': 'æ€§æ ¼ä»æ…ˆæ¸©å’Œï¼Œæœ‰è¿›å–å¿ƒï¼Œå–œæ¬¢è‡ªç„¶å’Œè‡ªç”±',
                'ç«': 'æ€§æ ¼çƒ­æƒ…ä¸»åŠ¨ï¼Œæœ‰ç¤¼è²Œï¼Œåšäº‹ç§¯æä½†å®¹æ˜“æ€¥èº',
                'åœŸ': 'æ€§æ ¼æ•¦åšç¨³é‡ï¼Œè®²ä¿¡ç”¨ï¼Œä¸ºäººå¿ è¯šå¯é ',
                'é‡‘': 'æ€§æ ¼åˆšæ¯…æœæ–­ï¼Œæœ‰æ­£ä¹‰æ„Ÿï¼Œåšäº‹è®¤çœŸä½†è¾ƒå›ºæ‰§',
                'æ°´': 'æ€§æ ¼æ™ºæ…§çµæ´»ï¼Œå–„äºåº”å˜ï¼Œèªæ˜ä½†æ˜“å¤šè™‘'
            };
            html += `<p><strong>ã€æ€§æ ¼ç‰¹å¾ã€‘</strong>${genderText}ï¼Œ${dayGan}${dayWuxing}æ—¥å…ƒï¼Œ${xinggeMap[dayWuxing]}ã€‚</p>`;
            
            // 6. å»ºè®®
            html += `<p class="mt-3 pt-3 border-t border-blue-200"><strong>ã€äººç”Ÿå»ºè®®ã€‘</strong>é¡ºåº”å¤©æ—¶ï¼ŒæŠŠæ¡æœºé‡ï¼Œæ‰¬é•¿é¿çŸ­ï¼Œè¶‹å‰é¿å‡¶ã€‚${riYuanStrength === 'èº«æ—º' ? 'èº«æ—ºè€…å®œæ³„ä¸å®œåŠ©ã€‚' : riYuanStrength === 'èº«å¼±' ? 'èº«å¼±è€…å®œæ‰¶ä¸å®œå…‹ã€‚' : 'æ—¥ä¸»ä¸­å’Œï¼Œå¹³è¡¡ä¸ºè´µã€‚'}å‘½è¿æŒæ¡åœ¨è‡ªå·±æ‰‹ä¸­ï¼Œç§¯å–„è¡Œå¾·ï¼Œè‡ªæœ‰ç¦æŠ¥ã€‚</p>`;
            
            return html;
        }

        // ============ æ¸²æŸ“å…«å­—æ’ç›˜ç»“æœ ============
        function renderBaziResult(bazi, lunar, solar, userName, userGender) {
            const container = document.getElementById('baziResult');
            
            // è·å–å…«å­—ä¿¡æ¯
            const yearGan = bazi.getYearGan();
            const yearZhi = bazi.getYearZhi();
            const monthGan = bazi.getMonthGan();
            const monthZhi = bazi.getMonthZhi();
            const dayGan = bazi.getDayGan();
            const dayZhi = bazi.getDayZhi();
            const timeGan = bazi.getTimeGan();
            const timeZhi = bazi.getTimeZhi();

            // è·å–äº”è¡Œç»Ÿè®¡
            const wuxingCount = {'é‡‘': 0, 'æœ¨': 0, 'æ°´': 0, 'ç«': 0, 'åœŸ': 0};
            [yearGan, yearZhi, monthGan, monthZhi, dayGan, dayZhi, timeGan, timeZhi].forEach(char => {
                const wx = WUXING_MAP[char];
                if (wx) wuxingCount[wx]++;
            });
            const wuxingStr = Object.keys(wuxingCount).map(k => `${k}(${wuxingCount[k]})`).join('ï¼Œ');

            // è®¡ç®—èµ·è¿ä¿¡æ¯
            const yun = bazi.getYun(userGender);
            const startYear = yun.getStartYear();  // èµ·è¿å¹´æ•°
            const startMonth = yun.getStartMonth();  // èµ·è¿æœˆæ•°
            const startDay = yun.getStartDay();  // èµ·è¿å¤©æ•°
            const startSolar = yun.getStartSolar();
            
            // è·å–å‘½å®«ã€èƒå…ƒ
            const mingGong = bazi.getMingGong();
            const taiYuan = bazi.getTaiYuan();

            // è·å–ç©ºäº¡ï¼ˆä»æ—¥æŸ±è·å–ï¼‰
            const xun = lunar.getDayXun();
            const kongWang = lunar.getDayXunKong();
            
            // ============ ç²¾å‡†åˆ¤æ–­èº«å¼ºèº«å¼±ï¼ˆä¸‰æ­¥åŠ æƒæ³•ï¼‰============
            const dayWuxing = WUXING_MAP[dayGan];
            const monthWuxing = WUXING_MAP[monthZhi];
            
            let totalScore = 0; // æ€»åˆ†ï¼Œæ»¡åˆ†100ï¼Œ45-55ä¸ºä¸­å’Œ
            let analysisDetails = {};
            
            // äº”è¡Œç›¸ç”Ÿç›¸å…‹å…³ç³»
            const shengMap = {'æœ¨':'æ°´','ç«':'æœ¨','åœŸ':'ç«','é‡‘':'åœŸ','æ°´':'é‡‘'}; // ç”Ÿæˆ‘
            const keMap = {'æœ¨':'é‡‘','ç«':'æ°´','åœŸ':'æœ¨','é‡‘':'ç«','æ°´':'åœŸ'}; // å…‹æˆ‘
            const woShengMap = {'æœ¨':'ç«','ç«':'åœŸ','åœŸ':'é‡‘','é‡‘':'æ°´','æ°´':'æœ¨'}; // æˆ‘ç”Ÿ
            const woKeMap = {'æœ¨':'åœŸ','ç«':'é‡‘','åœŸ':'æ°´','é‡‘':'æœ¨','æ°´':'ç«'}; // æˆ‘å…‹
            
            // ç¬¬ä¸€æ­¥ï¼šæœˆä»¤å¾—å¤±ï¼ˆæƒé‡50%ï¼‰
            let yuelingScore = 0;
            let yuelingStatus = '';
            
            if (monthWuxing === dayWuxing) {
                // æ—ºï¼šåŒæˆ‘
                yuelingScore = 50;
                yuelingStatus = 'å¾—ä»¤ï¼ˆæ—ºï¼‰';
            } else if (monthWuxing === shengMap[dayWuxing]) {
                // ç›¸ï¼šç”Ÿæˆ‘
                yuelingScore = 40;
                yuelingStatus = 'å¾—ä»¤ï¼ˆç›¸ï¼‰';
            } else if (monthWuxing === woShengMap[dayWuxing]) {
                // æ³„ï¼šæˆ‘ç”Ÿ
                yuelingScore = -25;
                yuelingStatus = 'å¤±ä»¤ï¼ˆæ³„ï¼‰';
            } else if (monthWuxing === woKeMap[dayWuxing]) {
                // è€—ï¼šæˆ‘å…‹
                yuelingScore = -20;
                yuelingStatus = 'å¤±ä»¤ï¼ˆè€—ï¼‰';
            } else if (monthWuxing === keMap[dayWuxing]) {
                // å…‹ï¼šå…‹æˆ‘
                yuelingScore = -30;
                yuelingStatus = 'å¤±ä»¤ï¼ˆå…‹ï¼‰';
            }
            totalScore += yuelingScore;
            analysisDetails.yuelingScore = yuelingScore;
            analysisDetails.yuelingStatus = yuelingStatus;
            
            // ç¬¬äºŒæ­¥ï¼šåœ°æ”¯è—æ ¹ï¼ˆæƒé‡30%ï¼‰
            let dizhiScore = 0;
            const zhiList = [
                {zhi: yearZhi, weight: 0.5},  // å¹´æ”¯
                {zhi: monthZhi, weight: 0.7}, // æœˆæ”¯
                {zhi: dayZhi, weight: 1.0},   // æ—¥æ”¯ï¼ˆæœ€é‡è¦ï¼‰
                {zhi: timeZhi, weight: 0.8}   // æ—¶æ”¯
            ];
            
            // é˜³å¹²é•¿ç”Ÿè¡¨ï¼ˆç‰¹æ®Šå¼ºæ ¹ï¼‰
            const changshengRoot = {
                'ç”²': 'äº¥', 'ä¸™': 'å¯…', 'æˆŠ': 'å¯…', 'åºš': 'å·³', 'å£¬': 'ç”³'
            };
            
            zhiList.forEach(item => {
                const cangGans = getCangGan(item.zhi);
                let hasRoot = false;
                let rootStrength = 0;
                
                // æœ¬æ°”æ ¹ï¼ˆæœ€å¼ºï¼‰
                if (cangGans[0] === dayGan || WUXING_MAP[cangGans[0]] === dayWuxing) {
                    rootStrength = 10 * item.weight;
                    hasRoot = true;
                }
                // é˜³å¹²é•¿ç”Ÿä½ï¼ˆå¼ºæ ¹ï¼‰
                else if (changshengRoot[dayGan] === item.zhi) {
                    rootStrength = 8 * item.weight;
                    hasRoot = true;
                }
                // ä¸­æ°”ä½™æ°”æ ¹
                else if (cangGans.some(cg => WUXING_MAP[cg] === dayWuxing)) {
                    rootStrength = 4 * item.weight;
                    hasRoot = true;
                }
                // å°æ˜Ÿï¼ˆç”Ÿæˆ‘çš„ï¼‰ä¹Ÿç®—å¸®æ‰¶
                else if (cangGans.some(cg => WUXING_MAP[cg] === shengMap[dayWuxing])) {
                    rootStrength = 3 * item.weight;
                }
                
                dizhiScore += rootStrength;
            });
            
            totalScore += dizhiScore;
            analysisDetails.dizhiScore = dizhiScore;
            
            // ç¬¬ä¸‰æ­¥ï¼šå¤©å¹²å¸®æ‰¶ï¼ˆæƒé‡20%ï¼‰
            let tianganScore = 0;
            const helpGanList = [yearGan, monthGan, timeGan]; // ä¸ç®—æ—¥å¹²è‡ªå·±
            
            helpGanList.forEach(gan => {
                const ganWuxing = WUXING_MAP[gan];
                if (ganWuxing === dayWuxing) {
                    // æ¯”åŠ«
                    tianganScore += 5;
                } else if (ganWuxing === shengMap[dayWuxing]) {
                    // å°æ˜Ÿ
                    tianganScore += 4;
                } else if (ganWuxing === woShengMap[dayWuxing]) {
                    // é£Ÿä¼¤ï¼ˆæ³„ï¼‰
                    tianganScore -= 2;
                } else if (ganWuxing === woKeMap[dayWuxing]) {
                    // è´¢æ˜Ÿï¼ˆè€—ï¼‰
                    tianganScore -= 2;
                } else if (ganWuxing === keMap[dayWuxing]) {
                    // å®˜æ€ï¼ˆå…‹ï¼‰
                    tianganScore -= 3;
                }
            });
            
            totalScore += tianganScore;
            analysisDetails.tianganScore = tianganScore;
            analysisDetails.totalScore = totalScore;
            
            // æœ€ç»ˆåˆ¤å®š
            let riYuanStrength = 'ä¸­å’Œ';
            if (totalScore >= 55) {
                riYuanStrength = 'èº«æ—º';
            } else if (totalScore <= 40) {
                riYuanStrength = 'èº«å¼±';
            }
            
            console.log('èº«å¼ºèº«å¼±è¯¦ç»†åˆ†æ:', {
                dayGan, dayWuxing, monthZhi, monthWuxing,
                æœˆä»¤å¾—åˆ†: yuelingScore, æœˆä»¤çŠ¶æ€: yuelingStatus,
                åœ°æ”¯å¾—åˆ†: dizhiScore.toFixed(1),
                å¤©å¹²å¾—åˆ†: tianganScore,
                æ€»åˆ†: totalScore.toFixed(1),
                åˆ¤å®š: riYuanStrength
            });
            
            // è·å–å…¬å†å†œå†ä¿¡æ¯
            const solarDate = `${solar.getYear()}å¹´${String(solar.getMonth()).padStart(2, '0')}æœˆ${String(solar.getDay()).padStart(2, '0')}æ—¥${String(solar.getHour()).padStart(2, '0')}æ—¶${String(solar.getMinute()).padStart(2, '0')}åˆ†`;
            const lunarDate = `${lunar.getYearInChinese()}å¹´(ç”Ÿè‚–${lunar.getYearShengXiao()})${lunar.getMonthInChinese()}æœˆ${lunar.getDayInChinese()}${lunar.getTimeZhi()}æ—¶`;

            // è®¡ç®—ç¥ç…ï¼ˆè·å–æ—¥æŸ±å’Œå¹´æ”¯çš„æ‰€æœ‰ç¥ç…ï¼‰
            const allShenSha = [];
            const ganZhiPairs = [
                {gan: yearGan, zhi: yearZhi},
                {gan: monthGan, zhi: monthZhi},
                {gan: dayGan, zhi: dayZhi},
                {gan: timeGan, zhi: timeZhi}
            ];
            const allZhiList = [yearZhi, monthZhi, dayZhi, timeZhi];
            const allGanList = [yearGan, monthGan, dayGan, timeGan];
            
            // ç¬¬ä¸€æ¬¡å¾ªç¯æ—¶ä¼ å…¥å®Œæ•´çš„å¹²æ”¯åˆ—è¡¨ç”¨äºè®¡ç®—æ–‡æ˜Œç­‰éœ€è¦äº¤å‰æŸ¥è¯¢çš„ç¥ç…
            ganZhiPairs.forEach((pair, index) => {
                const ss = calculateShenSha(
                    dayGan, dayZhi, yearZhi, monthZhi, pair.zhi, pair.gan, 
                    index === 0 ? yearGan : null,  // åªåœ¨ç¬¬ä¸€æ¬¡å¾ªç¯æ—¶ä¼ å…¥ï¼Œé¿å…é‡å¤è®¡ç®—
                    index === 0 ? monthGan : null, 
                    index === 0 ? timeGan : null, 
                    index === 0 ? allZhiList : null
                );
                allShenSha.push(...ss);
            });
            // å»é‡
            const uniqueShenSha = [...new Set(allShenSha)];
            console.log('è®¡ç®—å‡ºçš„ç¥ç…:', uniqueShenSha);
            console.log('å››æŸ±å¤©å¹²:', [yearGan, monthGan, dayGan, timeGan]);
            console.log('å››æŸ±åœ°æ”¯:', [yearZhi, monthZhi, dayZhi, timeZhi]);
            console.log('æ—¥å¹²:', dayGan, 'æ—¥æ”¯:', dayZhi, 'å¹´æ”¯:', yearZhi, 'æœˆæ”¯:', monthZhi);
            
            // æ‰‹åŠ¨éªŒè¯æ–‡æ˜Œè´µäºº
            console.log('=== æ–‡æ˜Œè´µäººéªŒè¯ ===');
            const verifyGanList = [
                {name: 'å¹´å¹²', gan: yearGan},
                {name: 'æœˆå¹²', gan: monthGan},
                {name: 'æ—¥å¹²', gan: dayGan},
                {name: 'æ—¶å¹²', gan: timeGan}
            ];
            const verifyZhiList = [yearZhi, monthZhi, dayZhi, timeZhi];
            verifyGanList.forEach(g => {
                if (SHENSHA.WenChang[g.gan]) {
                    console.log(`${g.name}${g.gan}çš„æ–‡æ˜Œä½æ˜¯: ${SHENSHA.WenChang[g.gan]}`);
                    const found = verifyZhiList.filter(z => SHENSHA.WenChang[g.gan].includes(z));
                    if (found.length > 0) {
                        console.log(`  âœ“ åœ¨å››æŸ±ä¸­æ‰¾åˆ°: ${found.join(', ')}`);
                    }
                }
            });

            const html = `
                <div class="max-w-6xl mx-auto">
                    <h2 class="text-2xl font-bold text-center mb-6 text-gray-800">å…«å­—æ’ç›˜ç»“æœ</h2>
                    
                    <!-- åŸºæœ¬ä¿¡æ¯ -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6 text-sm">
                        <div class="space-y-2">
                            <p><span class="font-bold">å§“åï¼š</span>${userName} &nbsp;&nbsp; <span class="font-bold">äº”è¡Œï¼š</span>${wuxingStr}</p>
                            <p><span class="font-bold">æ€§åˆ«ï¼š</span>${userGender === 1 ? 'ç”·' : 'å¥³'} &nbsp;&nbsp; <span class="font-bold">èƒå…ƒï¼š</span>${taiYuan} &nbsp;&nbsp; <span class="font-bold">å‘½å®«ï¼š</span>${mingGong}</p>
                            <p><span class="font-bold">èŠ‚æ°”ï¼š</span>${lunar.getPrevJieQi().getName()} ${lunar.getPrevJieQi().getSolar().toYmd()} &nbsp;&nbsp; ${lunar.getNextJieQi().getName()} ${lunar.getNextJieQi().getSolar().toYmd()}</p>
                        </div>
                        <div class="space-y-2">
                            <p><span class="font-bold">èµ·è¿ï¼š</span>å‘½ä¸»äºå‡ºç”Ÿå${startYear}å¹´${startMonth}æœˆ${startDay}æ—¥å¼€å§‹èµ·è¿</p>
                            <p><span class="font-bold">äº¤è¿ï¼š</span>å‘½ä¸»äºå…¬å†${startSolar.getYear()}å¹´${String(startSolar.getMonth()).padStart(2, '0')}æœˆ${String(startSolar.getDay()).padStart(2, '0')}æ—¥äº¤è¿</p>
                            <p><span class="font-bold">æ’ç›˜æ–¹å¼ï¼š</span>å…¬å†æ’ç›˜</p>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6 text-sm">
                        <p><span class="font-bold">å…¬å†ï¼š</span>${solarDate}</p>
                        <p><span class="font-bold">å†œå†ï¼š</span>${lunarDate}</p>
                    </div>

                    <!-- æ—¥å…ƒå¼ºå¼±æ˜¾ç¤º -->
                    <div class="mb-6 p-4 bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg border-2 ${riYuanStrength === 'èº«æ—º' ? 'border-green-400' : riYuanStrength === 'èº«å¼±' ? 'border-orange-400' : 'border-blue-400'}">
                        <div class="flex items-center justify-between mb-2">
                            <div>
                                <span class="text-sm text-gray-600">æ—¥å…ƒå¼ºå¼±ï¼š</span>
                                <span class="text-2xl font-bold ml-3 ${riYuanStrength === 'èº«æ—º' ? 'text-green-600' : riYuanStrength === 'èº«å¼±' ? 'text-orange-600' : 'text-blue-600'}">${riYuanStrength}</span>
                                <span class="text-sm text-gray-500 ml-2">(ç»¼åˆå¾—åˆ†: ${totalScore.toFixed(1)}åˆ†)</span>
                            </div>
                            <div class="text-sm text-gray-600">
                                ${riYuanStrength === 'èº«æ—º' ? 'ğŸ’ª æ—¥ä¸»åæ—ºï¼Œå®œæ³„ä¸å®œåŠ©' : riYuanStrength === 'èº«å¼±' ? 'ğŸŒ± æ—¥ä¸»åå¼±ï¼Œå®œæ‰¶ä¸å®œå…‹' : 'âš–ï¸ æ—¥ä¸»ä¸­å’Œï¼Œå¹³è¡¡ä¸ºè´µ'}
                            </div>
                        </div>
                        <div class="text-xs text-gray-500 flex gap-4">
                            <span>ğŸ“… æœˆä»¤${yuelingStatus}: ${yuelingScore > 0 ? '+' : ''}${yuelingScore}åˆ†</span>
                            <span>ğŸŒ³ åœ°æ”¯è—æ ¹: ${dizhiScore > 0 ? '+' : ''}${dizhiScore.toFixed(1)}åˆ†</span>
                            <span>â˜ï¸ å¤©å¹²å¸®æ‰¶: ${tianganScore > 0 ? '+' : ''}${tianganScore}åˆ†</span>
                        </div>
                    </div>

                    <!-- å››æŸ±è¡¨æ ¼ -->
                    <div class="overflow-x-auto">
                        <table class="w-full border-collapse text-center text-sm">
                            <thead>
                                <tr class="bg-gray-400 text-black">
                                    <th class="border border-gray-400 p-2">å››æŸ±</th>
                                    <th class="border border-gray-400 p-2">å¹´æŸ±</th>
                                    <th class="border border-gray-400 p-2">æœˆæŸ±</th>
                                    <th class="border border-gray-400 p-2">æ—¥æŸ±</th>
                                    <th class="border border-gray-400 p-2">æ—¶æŸ±</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white">
                                <tr>
                                    <td class="border border-gray-300 p-2 bg-gray-100 font-bold">åç¥</td>
                                    <td class="border border-gray-300 p-2">${getShiShen(dayGan, yearGan)}</td>
                                    <td class="border border-gray-300 p-2">${getShiShen(dayGan, monthGan)}</td>
                                    <td class="border border-gray-300 p-2 bg-blue-100"><span class="text-blue-600">å…ƒå¥³</span></td>
                                    <td class="border border-gray-300 p-2">${getShiShen(dayGan, timeGan)}</td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 bg-gray-200 font-bold">å¤©å¹²</td>
                                    <td class="border border-gray-300 p-2">
                                        <span class="text-2xl font-bold ${getWuxingClass(yearGan)}">${yearGan}</span>
                                    </td>
                                    <td class="border border-gray-300 p-2">
                                        <span class="text-2xl font-bold ${getWuxingClass(monthGan)}">${monthGan}</span>
                                    </td>
                                    <td class="border border-gray-300 p-2 bg-blue-50">
                                        <span class="text-2xl font-bold ${getWuxingClass(dayGan)}">${dayGan}</span>
                                    </td>
                                    <td class="border border-gray-300 p-2">
                                        <span class="text-2xl font-bold ${getWuxingClass(timeGan)}">${timeGan}</span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 bg-gray-200 font-bold">åœ°æ”¯</td>
                                    <td class="border border-gray-300 p-2">
                                        <span class="text-2xl font-bold ${getWuxingClass(yearZhi)}">${yearZhi}</span>
                                    </td>
                                    <td class="border border-gray-300 p-2">
                                        <span class="text-2xl font-bold ${getWuxingClass(monthZhi)}">${monthZhi}</span>
                                    </td>
                                    <td class="border border-gray-300 p-2 bg-blue-50">
                                        <span class="text-2xl font-bold ${getWuxingClass(dayZhi)}">${dayZhi}</span>
                                    </td>
                                    <td class="border border-gray-300 p-2">
                                        <span class="text-2xl font-bold ${getWuxingClass(timeZhi)}">${timeZhi}</span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 bg-gray-100 font-bold">è—å¹²</td>
                                    <td class="border border-gray-300 p-2 text-xs">
                                        ${getCangGan(yearZhi).map(g => `<span class="${getWuxingClass(g)}">${g}(${getShiShen(dayGan, g)})</span>`).join('<br>')}
                                    </td>
                                    <td class="border border-gray-300 p-2 text-xs">
                                        ${getCangGan(monthZhi).map(g => `<span class="${getWuxingClass(g)}">${g}(${getShiShen(dayGan, g)})</span>`).join('<br>')}
                                    </td>
                                    <td class="border border-gray-300 p-2 text-xs bg-blue-50">
                                        ${getCangGan(dayZhi).map(g => `<span class="${getWuxingClass(g)}">${g}(${getShiShen(dayGan, g)})</span>`).join('<br>')}
                                    </td>
                                    <td class="border border-gray-300 p-2 text-xs">
                                        ${getCangGan(timeZhi).map(g => `<span class="${getWuxingClass(g)}">${g}(${getShiShen(dayGan, g)})</span>`).join('<br>')}
                                    </td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 bg-gray-100 font-bold">çº³éŸ³</td>
                                    <td class="border border-gray-300 p-2 text-xs">${getNaYin(yearGan + yearZhi)}</td>
                                    <td class="border border-gray-300 p-2 text-xs">${getNaYin(monthGan + monthZhi)}</td>
                                    <td class="border border-gray-300 p-2 text-xs bg-blue-50">${getNaYin(dayGan + dayZhi)}</td>
                                    <td class="border border-gray-300 p-2 text-xs">${getNaYin(timeGan + timeZhi)}</td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 bg-gray-100 font-bold">ç©ºäº¡</td>
                                    <td class="border border-gray-300 p-2 text-sm" colspan="4">${kongWang}</td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-300 p-2 bg-gray-100 font-bold">ç¥ç…</td>
                                    <td class="border border-gray-300 p-2 text-xs" colspan="4">
                                        ${uniqueShenSha.length > 0 ? uniqueShenSha.map(s => {
                                            const jiShenList = ['å¤©ä¹™è´µäºº', 'å¤©å¾·è´µäºº', 'æœˆå¾·è´µäºº', 'æ–‡æ˜Œè´µäºº', 'æ–‡æ˜Œ', 'å¤ªæè´µäºº', 'å›½å°è´µäºº', 'ç¦„ç¥', 'å°†æ˜Ÿ', 'å¤©å¨è´µäºº', 'é‡‘èˆ†', 'çº¢é¸¾', 'å¤©å–œ', 'å­¦å ‚', 'å¤©å¾·åˆ', 'æœˆå¾·åˆ'];
                                            const isJi = jiShenList.includes(s);
                                            return `<span class="shensha-tag" style="background-color: ${isJi ? '#dcfce7' : '#fee2e2'}; color: ${isJi ? '#166534' : '#991b1b'}; border-color: ${isJi ? '#86efac' : '#fca5a5'}">${s}</span>`;
                                        }).join(' ') : '<span class="text-gray-400">æš‚æ— </span>'}
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- å‘½ç›˜ç»¼åˆåˆ†æ -->
                    <div class="mt-6 p-6 bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl border-2 border-blue-200">
                        <h3 class="text-lg font-bold text-gray-800 mb-3 flex items-center">
                            <span class="mr-2">ğŸ“Š</span>
                            å‘½ç›˜ç»¼åˆåˆ†æ
                        </h3>
                        <div class="text-sm leading-relaxed text-gray-700 space-y-2">
                            ${generateBaziSummary(bazi, wuxingCount, uniqueShenSha, userGender, riYuanStrength, totalScore, yuelingScore, dizhiScore, tianganScore, yuelingStatus)}
                        </div>
                    </div>
                </div>
            `;
            
            container.innerHTML = html;
            container.style.display = 'block';
        }

        // ============ æ¸²æŸ“åŸå±€å››æŸ± ============
        function renderNatalChart(bazi, lunar, userGender, birthDate) {
            const container = document.getElementById('natalChart');
            const pillars = [
                { title: 'å¹´æŸ±', gan: bazi.getYearGan(), zhi: bazi.getYearZhi(), icon: 'ğŸ‹' },
                { title: 'æœˆæŸ±', gan: bazi.getMonthGan(), zhi: bazi.getMonthZhi(), icon: 'ğŸŒ™' },
                { title: 'æ—¥æŸ±', gan: bazi.getDayGan(), zhi: bazi.getDayZhi(), icon: 'â˜€ï¸' },
                { title: 'æ—¶æŸ±', gan: bazi.getTimeGan(), zhi: bazi.getTimeZhi(), icon: 'â°' }
            ];

            let html = '';
            pillars.forEach(p => {
                const ganWuxing = WUXING_MAP[p.gan];
                const zhiWuxing = WUXING_MAP[p.zhi];
                html += `
                    <div class="pillar-card bg-white p-4 rounded-xl border-2 border-gray-300 shadow-md hover:shadow-xl">
                        <div class="text-gray-500 text-xs mb-2 flex justify-between items-center">
                            <span>${p.icon} ${p.title}</span>
                        </div>
                        <div class="flex justify-center items-center space-x-2">
                            <div class="text-center">
                                <div class="text-3xl ${getWuxingClass(p.gan)} gan">${p.gan}</div>
                                <div class="text-xs text-gray-400 mt-1">${ganWuxing}</div>
                            </div>
                            <div class="text-center">
                                <div class="text-3xl ${getWuxingClass(p.zhi)} zhi">${p.zhi}</div>
                                <div class="text-xs text-gray-400 mt-1">${zhiWuxing}</div>
                            </div>
                        </div>
                    </div>
                `;
            });
            container.innerHTML = html;

            // æ¸²æŸ“å¤§è¿è¯¦ç»†è¡¨æ ¼ï¼ˆä½¿ç”¨æ€§åˆ«å‚æ•°ï¼‰
            try {
                const dayunDetailContainer = document.getElementById('dayunDetailTable');
                if (!dayunDetailContainer) {
                    console.error('æ‰¾ä¸åˆ°dayunDetailTableå®¹å™¨');
                    return;
                }
                console.log('å¼€å§‹æ¸²æŸ“å¤§è¿è¯¦ç»†è¡¨æ ¼');
                
                const yun = bazi.getYun(userGender);
                const dayGanForDayun = bazi.getDayGan();
                
                // è®¡ç®—å½“å‰å¹´é¾„
                const now = new Date();
                const age = now.getFullYear() - birthDate.getFullYear();
                const birthYear = birthDate.getFullYear();
                
                const dayuns = yun.getDaYun();
                console.log('å¤§è¿æ•°é‡:', dayuns.length);
                
                if (dayuns && dayuns.length > 0) {
                // ç”Ÿæˆå¤§è¿è¡¨æ ¼
                let tableHtml = '<table class="w-full border-collapse text-center text-xs">';
                
                // ç¬¬ä¸€è¡Œï¼šå¹´é¾„
                tableHtml += '<tr class="border-b-2 border-gray-400">';
                tableHtml += '<td class="p-2 font-bold text-left">å²æ•°</td>';
                dayuns.slice(0, 9).forEach(dy => {
                    const startAge = dy.getStartAge();
                    const endAge = dy.getEndAge();
                    tableHtml += `<td class="p-2 font-bold">${String(startAge).padStart(2, '0')}å²</td>`;
                });
                tableHtml += '</tr>';
                
                // ç¬¬äºŒè¡Œï¼šå¤§è¿å§‹äºï¼ˆå…¬å†å¹´ä»½ï¼‰
                tableHtml += '<tr class="bg-gray-50 border-b border-gray-300">';
                tableHtml += '<td class="p-2 text-left">å¤§è¿å§‹äº</td>';
                dayuns.slice(0, 9).forEach(dy => {
                    const startAge = dy.getStartAge();
                    const calculatedYear = birthYear + startAge;
                    tableHtml += `<td class="p-2">${calculatedYear}</td>`;
                });
                tableHtml += '</tr>';
                
                // ç¬¬ä¸‰è¡Œï¼šå¤©å¹²åç¥
                tableHtml += '<tr class="border-b border-gray-300">';
                tableHtml += '<td class="p-2 font-bold text-left">å¤©å¹²åç¥</td>';
                dayuns.slice(0, 9).forEach(dy => {
                    const ganZhi = dy.getGanZhi();
                    const gan = ganZhi.substring(0, 1);
                    const shiShen = getShiShen(dayGanForDayun, gan);
                    tableHtml += `<td class="p-2 ${getWuxingClass(gan)}">${shiShen}</td>`;
                });
                tableHtml += '</tr>';
                
                // ç¬¬å››è¡Œï¼šå¤§è¿å¹²æ”¯
                tableHtml += '<tr class="bg-blue-50 border-b-2 border-gray-400">';
                tableHtml += '<td class="p-2 font-bold text-left">å¤§è¿</td>';
                dayuns.slice(0, 9).forEach(dy => {
                    const ganZhi = dy.getGanZhi();
                    const gan = ganZhi.substring(0, 1);
                    const zhi = ganZhi.substring(1, 2);
                    tableHtml += `<td class="p-3">
                        <div class="text-xl font-bold">
                            <span class="${getWuxingClass(gan)}">${gan}</span><span class="${getWuxingClass(zhi)}">${zhi}</span>
                        </div>
                    </td>`;
                });
                tableHtml += '</tr>';
                
                // ç¬¬äº”è¡Œï¼šåœ°æ”¯è—å¹²åŠåç¥
                tableHtml += '<tr class="border-b border-gray-300">';
                tableHtml += '<td class="p-2 font-bold text-left">åœ°æ”¯åç¥</td>';
                dayuns.slice(0, 9).forEach(dy => {
                    const ganZhi = dy.getGanZhi();
                    const zhi = ganZhi.substring(1, 2);
                    const cangGans = getCangGan(zhi);
                    let cangGanHtml = '';
                    cangGans.forEach(cg => {
                        const cgShiShen = getShiShen(dayGanForDayun, cg);
                        cangGanHtml += `<div class="text-xs ${getWuxingClass(cg)}">${cg}<br>${cgShiShen}</div>`;
                    });
                    tableHtml += `<td class="p-2 leading-tight">${cangGanHtml}</td>`;
                });
                tableHtml += '</tr>';
                
                // ç¬¬å…­è¡Œï¼šåäºŒé•¿ç”Ÿ
                tableHtml += '<tr class="border-b border-gray-300 bg-gray-50">';
                tableHtml += '<td class="p-2 font-bold text-left">åäºŒé•¿ç”Ÿ</td>';
                dayuns.slice(0, 9).forEach(dy => {
                    const ganZhi = dy.getGanZhi();
                    const zhi = ganZhi.substring(1, 2);
                    const changSheng = getChangSheng(dayGanForDayun, zhi);
                    tableHtml += `<td class="p-2">${changSheng}</td>`;
                });
                tableHtml += '</tr>';
                
                // ç¬¬ä¸ƒè¡Œï¼šå¤§è¿æ­¢äº
                tableHtml += '<tr class="border-b-2 border-gray-400">';
                tableHtml += '<td class="p-2 text-left">å¤§è¿æ­¢äº</td>';
                dayuns.slice(0, 9).forEach(dy => {
                    const endAge = dy.getEndAge();
                    const calculatedYear = birthYear + endAge;
                    tableHtml += `<td class="p-2">${calculatedYear}</td>`;
                });
                tableHtml += '</tr>';
                
                tableHtml += '</table>';
                
                // æ·»åŠ è¯´æ˜
                tableHtml += `<div class="mt-4 text-xs text-gray-600">
                    <p>ğŸ’¡ <strong>æç¤ºï¼š</strong>èµ·è¿å¹´é¾„ ${yun.getStartYear()}å²${yun.getStartMonth()}æœˆ${yun.getStartDay()}å¤©ï¼Œå½“å‰å¹´é¾„çº¦ ${age} å²ã€‚å¤§è¿æ¯10å¹´ä¸€æ¢ã€‚</p>
                </div>`;
                
                dayunDetailContainer.innerHTML = tableHtml;
                console.log('å¤§è¿è¡¨æ ¼æ¸²æŸ“å®Œæˆ');
            } else {
                console.warn('æ²¡æœ‰å¤§è¿æ•°æ®');
                dayunDetailContainer.innerHTML = '<p class="text-gray-500 p-4">æš‚æ— å¤§è¿æ•°æ®</p>';
            }
            } catch (e) {
                console.error('æ¸²æŸ“å¤§è¿è¡¨æ ¼å‡ºé”™:', e);
                const dayunDetailContainer = document.getElementById('dayunDetailTable');
                if (dayunDetailContainer) {
                    dayunDetailContainer.innerHTML = '<p class="text-red-500 p-4">å¤§è¿è¡¨æ ¼åŠ è½½å¤±è´¥: ' + e.message + '</p>';
                }
            }
        }

        // ============ ç”Ÿæˆæ¯æ—¥ç»¼åˆè§£è¯» V2 ============
        function generateDailyInterpretation(jianChu, shenshaList, ganNote, zhiNote, dayGan, dayZhi, monthGan, monthZhi, natalGan, natalZhi, isMonthChanged, monthShenshaList, yearGan, yearZhi, isYearChanged, yearShenshaList) {
            console.log('ç”Ÿæˆæ—¥è±¡è§£è¯» V2.0:', {jianChu, shenshaList, ganNote, zhiNote, dayGan, dayZhi, monthGan, monthZhi, monthShenshaList, yearGan, yearZhi, yearShenshaList});
            let interpretation = [];
            
            // 0. æµå¹´åˆ†æï¼ˆæµå¹´å˜åŒ–æ—¶æ˜¾ç¤ºï¼‰
            if (isYearChanged && yearGan && yearZhi) {
                interpretation.push('<div class="mb-2 pb-2 border-b border-blue-200"><strong class="text-blue-700">ã€æµå¹´äº¤æ›¿ï¼š' + yearGan + yearZhi + 'ã€‘</strong></div>');
                
                // æµå¹´ç¥ç…æç¤º
                if (yearShenshaList && yearShenshaList.length > 0) {
                    const jiShenInYear = ['å¤©ä¹™è´µäºº', 'æ–‡æ˜Œè´µäºº', 'ç¦„ç¥', 'å¤©å¾·', 'æœˆå¾·'].filter(s => yearShenshaList.includes(s));
                    const xiongShenInYear = ['ç¾Šåˆƒ', 'åŠ«ç…', 'ç¾ç…', 'ç™½è™'].filter(s => yearShenshaList.includes(s));
                    
                    if (jiShenInYear.length > 0) {
                        interpretation.push('<span class="text-green-600">ğŸŒŸ æœ¬å¹´å‰ç¥ï¼š' + jiShenInYear.join('ã€') + '</span>');
                    }
                    if (xiongShenInYear.length > 0) {
                        interpretation.push('<span class="text-orange-600">âš ï¸ æœ¬å¹´å‡¶ç…ï¼š' + xiongShenInYear.join('ã€') + 'ï¼Œéœ€è°¨æ…</span>');
                    }
                }
                
                // æµå¹´ä¸å‘½å±€çš„å…³ç³»
                const yearGanInteraction = checkInteractions(yearGan, natalGan, 'Gan');
                const yearZhiInteraction = checkInteractions(yearZhi, natalZhi, 'Zhi');
                
                if (yearGanInteraction || yearZhiInteraction) {
                    let yearNote = '<span class="text-blue-600">ğŸŠ æœ¬å¹´è¿åŠ¿ï¼š';
                    if (yearGanInteraction && yearGanInteraction.includes('åˆ')) {
                        yearNote += 'å¤©å¹²ç›¸åˆï¼Œæœ¬å¹´å‰ç¥¥ï¼›';
                    } else if (yearGanInteraction && yearGanInteraction.includes('å†²')) {
                        yearNote += 'å¤©å¹²ç›¸å†²ï¼Œæœ¬å¹´å¤šå˜ï¼›';
                    }
                    
                    if (yearZhiInteraction && yearZhiInteraction.includes('åˆ')) {
                        yearNote += 'åœ°æ”¯ç›¸åˆï¼Œè´µäººåŠ©åŠ›ï¼›';
                    } else if (yearZhiInteraction && yearZhiInteraction.includes('å†²')) {
                        yearNote += 'åœ°æ”¯ç›¸å†²ï¼ŒåŠ¨è¡ä¸å®‰ï¼›';
                    } else if (yearZhiInteraction && yearZhiInteraction.includes('åˆ‘')) {
                        yearNote += 'åœ°æ”¯ç›¸åˆ‘ï¼Œé˜²å®˜éï¼›';
                    } else if (yearZhiInteraction && yearZhiInteraction.includes('å®³')) {
                        yearNote += 'åœ°æ”¯ç›¸å®³ï¼Œé˜²æš—æŸï¼›';
                    }
                    yearNote = yearNote.replace(/ï¼›$/, '') + '</span>';
                    interpretation.push(yearNote);
                }
                
                // æµå¹´äº”è¡Œæç¤º
                const yearGanWuxing = WUXING_MAP[yearGan];
                const yearZhiWuxing = WUXING_MAP[yearZhi];
                const wuxingTips = {
                    'æœ¨': 'æœ¬å¹´æœ¨æ°”æ—ºï¼Œå®œè¿›å–åˆ›ä¸šï¼Œåˆ©ä¸œæ–¹',
                    'ç«': 'æœ¬å¹´ç«æ°”æ—ºï¼Œå®œå±•ç°æ‰åï¼Œåˆ©å—æ–¹',
                    'åœŸ': 'æœ¬å¹´åœŸæ°”æ—ºï¼Œå®œç¨³å¥æŠ•èµ„ï¼Œåˆ©ä¸­å¤®',
                    'é‡‘': 'æœ¬å¹´é‡‘æ°”æ—ºï¼Œå®œæ”¹é©åˆ›æ–°ï¼Œåˆ©è¥¿æ–¹',
                    'æ°´': 'æœ¬å¹´æ°´æ°”æ—ºï¼Œå®œå­¦ä¹ è¿›ä¿®ï¼Œåˆ©åŒ—æ–¹'
                };
                if (yearGanWuxing === yearZhiWuxing && wuxingTips[yearGanWuxing]) {
                    interpretation.push(`<span class="text-indigo-600">âœ¨ ${wuxingTips[yearGanWuxing]}</span>`);
                }
            }
            
            // 1. æµæœˆåˆ†æï¼ˆæµæœˆå˜åŒ–æ—¶æ˜¾ç¤ºï¼‰
            if (isMonthChanged && monthGan && monthZhi) {
                interpretation.push('<div class="mb-2 pb-2 border-b border-purple-200"><strong class="text-purple-700">ã€æµæœˆäº¤èŠ‚ï¼š' + monthGan + monthZhi + 'ã€‘</strong></div>');
                
                // æµæœˆç¥ç…æç¤º
                if (monthShenshaList && monthShenshaList.length > 0) {
                    const jiShenInMonth = ['å¤©ä¹™è´µäºº', 'æ–‡æ˜Œè´µäºº', 'ç¦„ç¥', 'å¤©å¾·', 'æœˆå¾·'].filter(s => monthShenshaList.includes(s));
                    const xiongShenInMonth = ['ç¾Šåˆƒ', 'åŠ«ç…', 'ç¾ç…', 'ç™½è™'].filter(s => monthShenshaList.includes(s));
                    
                    if (jiShenInMonth.length > 0) {
                        interpretation.push('<span class="text-green-600">âœ¨ æœ¬æœˆå‰ç¥ï¼š' + jiShenInMonth.join('ã€') + '</span>');
                    }
                    if (xiongShenInMonth.length > 0) {
                        interpretation.push('<span class="text-orange-600">âš ï¸ æœ¬æœˆå‡¶ç…ï¼š' + xiongShenInMonth.join('ã€') + 'ï¼Œéœ€è°¨æ…</span>');
                    }
                }
                
                // æµæœˆä¸å‘½å±€çš„å…³ç³»
                const monthGanInteraction = checkInteractions(monthGan, natalGan, 'Gan');
                const monthZhiInteraction = checkInteractions(monthZhi, natalZhi, 'Zhi');
                
                if (monthGanInteraction || monthZhiInteraction) {
                    let monthNote = '<span class="text-purple-600">ğŸŒ™ æœ¬æœˆè¿åŠ¿ï¼š';
                    if (monthGanInteraction && monthGanInteraction.includes('åˆ')) {
                        monthNote += 'å¤©å¹²ç›¸åˆï¼Œæœ¬æœˆé¡ºé‚ï¼›';
                    } else if (monthGanInteraction && monthGanInteraction.includes('å†²')) {
                        monthNote += 'å¤©å¹²ç›¸å†²ï¼Œæœ¬æœˆå¤šå˜ï¼›';
                    }
                    
                    if (monthZhiInteraction && monthZhiInteraction.includes('åˆ')) {
                        monthNote += 'åœ°æ”¯ç›¸åˆï¼Œæ˜“å¾—åŠ©åŠ›ï¼›';
                    } else if (monthZhiInteraction && monthZhiInteraction.includes('å†²')) {
                        monthNote += 'åœ°æ”¯ç›¸å†²ï¼Œé˜²çªå‘äº‹ï¼›';
                    } else if (monthZhiInteraction && monthZhiInteraction.includes('åˆ‘')) {
                        monthNote += 'åœ°æ”¯ç›¸åˆ‘ï¼Œé˜²å°äººï¼›';
                    } else if (monthZhiInteraction && monthZhiInteraction.includes('å®³')) {
                        monthNote += 'åœ°æ”¯ç›¸å®³ï¼Œå®œä½è°ƒï¼›';
                    }
                    monthNote = monthNote.replace(/ï¼›$/, '') + '</span>';
                    interpretation.push(monthNote);
                }
                
                // æµæœˆäº”è¡Œæç¤º
                const monthGanWuxing = WUXING_MAP[monthGan];
                const monthZhiWuxing = WUXING_MAP[monthZhi];
                const wuxingTips = {
                    'æœ¨': 'æœ¬æœˆæœ¨æ°”æ—ºï¼Œå®œå¤šäº²è¿‘è‡ªç„¶ï¼Œåˆ©åˆ›ä¸šå‘å±•',
                    'ç«': 'æœ¬æœˆç«æ°”æ—ºï¼Œå®œç§¯æä¸»åŠ¨ï¼Œåˆ©å®£ä¼ æ¨å¹¿',
                    'åœŸ': 'æœ¬æœˆåœŸæ°”æ—ºï¼Œå®œç¨³å¥è¡Œäº‹ï¼Œåˆ©æŠ•èµ„ç½®ä¸š',
                    'é‡‘': 'æœ¬æœˆé‡‘æ°”æ—ºï¼Œå®œæœæ–­å†³ç­–ï¼Œåˆ©ç­¾çº¦åˆä½œ',
                    'æ°´': 'æœ¬æœˆæ°´æ°”æ—ºï¼Œå®œçµæ´»åº”å˜ï¼Œåˆ©å­¦ä¹ è¿›ä¿®'
                };
                if (monthGanWuxing === monthZhiWuxing && wuxingTips[monthGanWuxing]) {
                    interpretation.push(`<span class="text-blue-600">ğŸ’« ${wuxingTips[monthGanWuxing]}</span>`);
                }
            }
            
            // 1. å»ºé™¤åäºŒç¥å«ä¹‰
            const jianChuMeaning = {
                'å»º': 'ä¸»å¼€åˆ›ã€ç«‹ä¸šï¼Œå®œè®¢å©šã€å¼€ä¸šã€ä¸Šä»»ï¼Œå¿Œæ¬å®¶',
                'é™¤': 'ä¸»é™¤æ—§å¸ƒæ–°ï¼Œå®œç¥­ç¥€ã€åŒ»ç–—ã€ç ´å±‹ï¼Œå¿Œå‡ºè¡Œ',
                'æ»¡': 'ä¸»åœ†æ»¡ã€ä¸°æ”¶ï¼Œå®œå«å¨¶ã€ç¥ˆç¦ã€äº¤æ˜“ï¼Œå¿Œå°±åŒ»',
                'å¹³': 'ä¸»å¹³ç¨³ã€å¹³é¡ºï¼Œä¸‡äº‹çš†å¯ï¼Œå¹³å¹³æ— å¥‡',
                'å®š': 'ä¸»å®‰å®šã€ç¡®å®šï¼Œå®œè®¢å©šã€ç­¾çº¦ã€å®‰åºŠï¼Œå¿Œå‡ºè¡Œ',
                'æ‰§': 'ä¸»æ‰§è¡Œã€åšæŒï¼Œå®œæ•æ‰ã€è¯‰è®¼ï¼Œå¿Œå«å¨¶',
                'ç ´': 'ä¸»ç ´è´¥ã€å†²çªï¼Œè¯¸äº‹ä¸å®œï¼Œåªå®œç ´æ—§',
                'å±': 'ä¸»å±é™©ã€å±æœºï¼Œå®œæ±‚åŒ»ã€å®‰åºŠï¼Œå¿Œå‡ºè¡Œ',
                'æˆ': 'ä¸»æˆå°±ã€æˆåŠŸï¼Œå®œå¼€ä¸šã€å«å¨¶ã€å»ºé€ ï¼Œè¯¸äº‹å¤§å‰',
                'æ”¶': 'ä¸»æ”¶è·ã€æ”¶æ•›ï¼Œå®œæ±‚è´¢ã€æ”¶è´¦ï¼Œå¿Œå¼€ä¸š',
                'å¼€': 'ä¸»å¼€é€šã€å¼€å§‹ï¼Œå®œå¼€ä¸šã€æ±‚è´¢ã€å‡ºè¡Œï¼Œè¯¸äº‹å‰åˆ©',
                'é—­': 'ä¸»é—­å¡ã€ä¼‘å…»ï¼Œå®œåŸ‹è‘¬ã€ä¿®å¢“ï¼Œå¿Œå¼€ä¸šã€å‡ºè¡Œ'
            };
            
            if (jianChuMeaning[jianChu]) {
                interpretation.push(`<strong>${jianChu}æ—¥</strong>ï¼š${jianChuMeaning[jianChu]}`);
            }
            
            // 2. ç¥ç…å‰å‡¶åˆ†æ
            const jiShen = ['å¤©ä¹™è´µäºº', 'æ–‡æ˜Œè´µäºº', 'å¤©å¾·', 'æœˆå¾·', 'å¤©å¾·åˆ', 'æœˆå¾·åˆ', 'ç¦„ç¥', 'å°†æ˜Ÿ', 'é‡‘èˆ†', 'çº¢é¸¾', 'å¤©å–œ', 'å¤ªæè´µäºº', 'å›½å°è´µäºº', 'å¤©å¨è´µäºº'];
            const xiongShen = ['åŠ«ç…', 'ç¾ç…', 'äº¡ç¥', 'ç¾Šåˆƒ', 'å…ƒè¾°', 'ç™½è™', 'ä¸§é—¨', 'åŠå®¢', 'æŠ«éº»', 'å­¤è¾°', 'å¯¡å®¿'];
            const zhongShen = ['æ¡ƒèŠ±', 'çº¢è‰³', 'é©¿é©¬', 'åç›–', 'å’¸æ± '];
            
            const hasJiShen = shenshaList.filter(s => jiShen.includes(s));
            const hasXiongShen = shenshaList.filter(s => xiongShen.includes(s));
            const hasZhongShen = shenshaList.filter(s => zhongShen.includes(s));
            
            if (hasJiShen.length > 0) {
                let jixiangDesc = '';
                if (hasJiShen.includes('å¤©ä¹™è´µäºº')) jixiangDesc += 'è´µäººç›¸åŠ©ï¼Œ';
                if (hasJiShen.includes('æ–‡æ˜Œè´µäºº')) jixiangDesc += 'åˆ©å­¦ä¸šè€ƒè¯•ï¼Œ';
                if (hasJiShen.includes('ç¦„ç¥')) jixiangDesc += 'åˆ©æ±‚è´¢è¿›ç¦„ï¼Œ';
                if (hasJiShen.includes('å¤©å¾·') || hasJiShen.includes('æœˆå¾·')) jixiangDesc += 'é€¢å‡¶åŒ–å‰ï¼Œ';
                if (hasJiShen.includes('çº¢é¸¾') || hasJiShen.includes('å¤©å–œ')) jixiangDesc += 'å–œäº‹ä¸´é—¨ï¼Œ';
                interpretation.push(`<span class="text-green-600">âœ“ ${jixiangDesc.replace(/ï¼Œ$/, '')}</span>`);
            }
            
            if (hasXiongShen.length > 0) {
                let xiongzhaoDesc = '';
                if (hasXiongShen.includes('ç¾Šåˆƒ')) xiongzhaoDesc += 'é˜²è¡€å…‰ä¹‹ç¾ï¼Œ';
                if (hasXiongShen.includes('åŠ«ç…') || hasXiongShen.includes('ç¾ç…')) xiongzhaoDesc += 'é˜²æ„å¤–æŸå¤±ï¼Œ';
                if (hasXiongShen.includes('ç™½è™')) xiongzhaoDesc += 'é˜²å£èˆŒæ˜¯éï¼Œ';
                if (hasXiongShen.includes('ä¸§é—¨') || hasXiongShen.includes('åŠå®¢')) xiongzhaoDesc += 'é˜²å­æœä¹‹äº‹ï¼Œ';
                interpretation.push(`<span class="text-orange-600">âš  ${xiongzhaoDesc.replace(/ï¼Œ$/, '')}</span>`);
            }
            
            if (hasZhongShen.length > 0) {
                if (hasZhongShen.includes('é©¿é©¬')) interpretation.push('<span class="text-blue-600">â†’ å®œå‡ºè¡Œèµ°åŠ¨ã€å¤–å‡ºåŠäº‹</span>');
                if (hasZhongShen.includes('æ¡ƒèŠ±') || hasZhongShen.includes('çº¢è‰³')) interpretation.push('<span class="text-pink-600">ğŸ’• äººç¼˜ä½³ã€å¼‚æ€§ç¼˜æ—º</span>');
                if (hasZhongShen.includes('åç›–')) interpretation.push('<span class="text-purple-600">ğŸ¨ é€‚åˆè‰ºæœ¯åˆ›ä½œã€ä¿®è¡Œ</span>');
            }
            
            // 3. åˆ‘å†²åˆå®³åˆ†æ
            if (ganNote || zhiNote) {
                const hasChong = (ganNote && ganNote.includes('å†²')) || (zhiNote && zhiNote.includes('å†²'));
                const hasHe = (ganNote && ganNote.includes('åˆ')) || (zhiNote && zhiNote.includes('åˆ'));
                const hasXing = zhiNote && zhiNote.includes('åˆ‘');
                const hasHai = zhiNote && zhiNote.includes('å®³');
                
                if (hasChong) {
                    interpretation.push('<span class="text-red-600">âš¡ ä»Šæ—¥ä¸å‘½å±€ç›¸å†²ï¼Œè¯¸äº‹è°¨æ…ï¼Œé˜²çªå‘å˜åŠ¨</span>');
                } else if (hasHe) {
                    interpretation.push('<span class="text-green-600">ğŸ¤ ä»Šæ—¥ä¸å‘½å±€ç›¸åˆï¼Œäº‹åŠåŠŸå€ï¼Œæ˜“å¾—åŠ©åŠ›</span>');
                } else if (hasXing) {
                    interpretation.push('<span class="text-orange-600">âš  ä»Šæ—¥ä¸å‘½å±€ç›¸åˆ‘ï¼Œé˜²å°äººã€é˜²å£èˆŒ</span>');
                } else if (hasHai) {
                    interpretation.push('<span class="text-yellow-600">âš  ä»Šæ—¥ä¸å‘½å±€ç›¸å®³ï¼Œé˜²æš—æŸã€é˜²å°äºº</span>');
                }
            }
            
            // 4. äº”è¡Œå»ºè®®ï¼ˆæ ¹æ®äº”è¡Œç›¸ç”Ÿç›¸å…‹åŸç†ï¼Œæ—ºåˆ™å…‹ä¹‹æˆ–æ³„ä¹‹ï¼‰
            const ganWuxing = WUXING_MAP[dayGan];
            const zhiWuxing = WUXING_MAP[dayZhi];
            if (ganWuxing === zhiWuxing) {
                // äº”è¡Œæ—ºæ—¶ï¼Œåº”è¯¥ç©¿å…‹åˆ¶æˆ–æ³„æ°”çš„é¢œè‰²
                // æ ¼å¼ï¼š{å…‹åˆ¶é¢œè‰²/æ³„æ°”é¢œè‰²}
                const colorMap = {
                    'æœ¨':'ç™½/é‡‘è‰²ï¼ˆé‡‘å…‹æœ¨ï¼‰æˆ–çº¢è‰²ï¼ˆæœ¨ç”Ÿç«æ³„æœ¨ï¼‰',
                    'ç«':'é»‘/è“è‰²ï¼ˆæ°´å…‹ç«ï¼‰æˆ–é»„/æ£•è‰²ï¼ˆç«ç”ŸåœŸæ³„ç«ï¼‰',
                    'åœŸ':'ç»¿è‰²ï¼ˆæœ¨å…‹åœŸï¼‰æˆ–ç™½/é‡‘è‰²ï¼ˆåœŸç”Ÿé‡‘æ³„åœŸï¼‰',
                    'é‡‘':'çº¢è‰²ï¼ˆç«å…‹é‡‘ï¼‰æˆ–é»‘/è“è‰²ï¼ˆé‡‘ç”Ÿæ°´æ³„é‡‘ï¼‰',
                    'æ°´':'é»„/æ£•è‰²ï¼ˆåœŸå…‹æ°´ï¼‰æˆ–ç»¿è‰²ï¼ˆæ°´ç”Ÿæœ¨æ³„æ°´ï¼‰'
                };
                interpretation.push(`<span class="text-gray-600">ğŸ’¡ ä»Šæ—¥${ganWuxing}æ°”è¾ƒæ—ºï¼Œå®œç©¿${colorMap[ganWuxing]}</span>`);
            }
            
            // 5. ç»¼åˆè¯„ä»·
            if (interpretation.length === 0) {
                return '<span class="text-gray-500">ä»Šæ—¥å¹³å’Œï¼Œæ— ç‰¹æ®Šäº‹é¡¹</span>';
            }
            
            return interpretation.join('<br>');
        }

        // ============ æ¸²æŸ“æµæ—¥æ—¥å† ============
        function renderDailyCalendar(bazi, year, month) {
            console.log('=== å¼€å§‹æ¸²æŸ“æµæ—¥æ—¥å† ===', year, month);
            const tbody = document.getElementById('dailyTable');
            if (!tbody) {
                console.error('æ‰¾ä¸åˆ°dailyTableå®¹å™¨');
                return;
            }
            // è·å–å½“æœˆç¬¬ä¸€å¤©å’Œæœ€åä¸€å¤©æ¥ç¡®å®šæµå¹´æµæœˆå¹²æ”¯èŒƒå›´
            const firstDaySolar = Solar.fromYmd(year, month, 1);
            const firstDayLunar = firstDaySolar.getLunar();
            const firstYearGanZhi = firstDayLunar.getYearInGanZhi();
            const firstMonthGanZhi = firstDayLunar.getMonthInGanZhi();
            
            const lastDaySolar = Solar.fromYmd(year, month, new Date(year, month, 0).getDate());
            const lastDayLunar = lastDaySolar.getLunar();
            const lastYearGanZhi = lastDayLunar.getYearInGanZhi();
            const lastMonthGanZhi = lastDayLunar.getMonthInGanZhi();
            
            // å¦‚æœå½“æœˆæœ‰æµå¹´äº¤æ›¿ï¼Œæ˜¾ç¤ºä¸¤ä¸ªæµå¹´
            const yearTitle = firstYearGanZhi === lastYearGanZhi 
                ? `æµå¹´ï¼š${firstYearGanZhi}` 
                : `æµå¹´ï¼š${firstYearGanZhi} â†’ ${lastYearGanZhi}`;
            
            // å¦‚æœå½“æœˆæœ‰æµæœˆäº¤èŠ‚ï¼Œæ˜¾ç¤ºä¸¤ä¸ªæµæœˆ
            const monthTitle = firstMonthGanZhi === lastMonthGanZhi 
                ? `æµæœˆï¼š${firstMonthGanZhi}` 
                : `æµæœˆï¼š${firstMonthGanZhi} â†’ ${lastMonthGanZhi}`;
            
            document.getElementById('calendarTitle').innerHTML = `${year}å¹´${month}æœˆæµæ—¥è¯¦æ‰¹ <span class="text-base font-normal ml-2"><span class="text-blue-600">${yearTitle}</span> | <span class="text-purple-600">${monthTitle}</span></span>`;
            tbody.innerHTML = '';
            console.log('å¼€å§‹æ¸²æŸ“æµæ—¥:', year, month, yearTitle, monthTitle);

            // è·å–åŸå±€å¹²æ”¯ç”¨äºæ¯”å¯¹
            const natalGan = { 
                Y: bazi.getYearGan(), 
                M: bazi.getMonthGan(), 
                D: bazi.getDayGan(), 
                T: bazi.getTimeGan() 
            };
            const natalZhi = { 
                Y: bazi.getYearZhi(), 
                M: bazi.getMonthZhi(), 
                D: bazi.getDayZhi(), 
                T: bazi.getTimeZhi() 
            };

            // è®¡ç®—å½“æœˆå¤©æ•°
            const daysInMonth = new Date(year, month, 0).getDate();
            console.log(`å½“æœˆå¤©æ•°: ${daysInMonth}`);
            
            // ç”¨äºè¿½è¸ªæµå¹´å’Œæµæœˆå˜åŒ–
            let previousYearGanZhi = '';
            let previousMonthGanZhi = '';
            
            for (let d = 1; d <= daysInMonth; d++) {
                const currentSolar = Solar.fromYmd(year, month, d);
                const currentLunar = currentSolar.getLunar();
                
                // è·å–æµå¹´å¹²æ”¯
                const yearGan = currentLunar.getYearGan();
                const yearZhi = currentLunar.getYearZhi();
                const yearGanZhi = currentLunar.getYearInGanZhi();
                
                // è·å–æµæœˆå¹²æ”¯
                const monthGan = currentLunar.getMonthGan();
                const monthZhi = currentLunar.getMonthZhi();
                const monthGanZhi = currentLunar.getMonthInGanZhi();
                
                // è®¡ç®—æµå¹´å¤©å¹²çš„åç¥
                const yearGanShishen = getShiShen(natalGan.D, yearGan);
                
                // æ£€æµ‹æµå¹´æ˜¯å¦å‘ç”Ÿå˜åŒ–
                const isYearChanged = (previousYearGanZhi === '' && d === 1) || (previousYearGanZhi !== '' && previousYearGanZhi !== yearGanZhi);
                
                // æ›´æ–°æµå¹´å¹²æ”¯è¿½è¸ª
                if (isYearChanged) {
                    if (previousYearGanZhi !== '') {
                        console.log(`ç¬¬${d}æ—¥æµå¹´äº¤æ›¿: ${previousYearGanZhi} â†’ ${yearGanZhi}`);
                    } else {
                        console.log(`ç¬¬${d}æ—¥æµå¹´: ${yearGanZhi}`);
                    }
                    previousYearGanZhi = yearGanZhi;
                }
                
                // è®¡ç®—æµå¹´åœ°æ”¯è—å¹²çš„åç¥ï¼ˆæµå¹´å˜åŒ–æ—¶æ˜¾ç¤ºï¼‰
                const yearCangGans = getCangGan(yearZhi);
                let yearCangGanShishenHtml = '';
                if (isYearChanged && yearCangGans.length > 0) {
                    yearCangGanShishenHtml = '<div class="text-xs text-gray-500 mt-1">';
                    yearCangGans.forEach(cg => {
                        const cgShishen = getShiShen(natalGan.D, cg);
                        yearCangGanShishenHtml += `<span class="${getWuxingClass(cg)}">${cg}</span>(${cgShishen}) `;
                    });
                    yearCangGanShishenHtml += '</div>';
                }
                
                // æµå¹´ä¸å‘½å±€çš„äº¤äº’ï¼ˆæµå¹´å˜åŒ–æ—¶è®¡ç®—æ˜¾ç¤ºï¼‰
                let yearInteractionNote = '';
                let yearShenshaList = [];
                if (isYearChanged) {
                    const yearGanNote = checkInteractions(yearGan, natalGan, 'Gan');
                    const yearZhiNote = checkInteractions(yearZhi, natalZhi, 'Zhi');
                    if (yearGanNote || yearZhiNote) {
                        yearInteractionNote = '<div class="mt-1 text-xs">';
                        if (yearGanNote) yearInteractionNote += yearGanNote;
                        if (yearZhiNote) yearInteractionNote += (yearGanNote ? '<br>' : '') + yearZhiNote;
                        yearInteractionNote += '</div>';
                    }
                    
                    // è®¡ç®—æµå¹´ç¥ç…
                    yearShenshaList = calculateShenSha(
                        natalGan.D, 
                        natalZhi.D, 
                        natalZhi.Y, 
                        natalZhi.M, 
                        yearZhi,
                        yearGan,
                        null, null, null, null
                    );
                }
                
                // è®¡ç®—æµæœˆå¤©å¹²çš„åç¥
                const monthGanShishen = getShiShen(natalGan.D, monthGan);
                
                // æ£€æµ‹æµæœˆæ˜¯å¦å‘ç”Ÿå˜åŒ–
                const isMonthChanged = (previousMonthGanZhi === '' && d === 1) || (previousMonthGanZhi !== '' && previousMonthGanZhi !== monthGanZhi);
                
                // æ›´æ–°æµæœˆå¹²æ”¯è¿½è¸ª
                if (isMonthChanged) {
                    if (previousMonthGanZhi !== '') {
                        console.log(`ç¬¬${d}æ—¥æµæœˆäº¤èŠ‚: ${previousMonthGanZhi} â†’ ${monthGanZhi}`);
                    } else {
                        console.log(`ç¬¬${d}æ—¥æµæœˆ: ${monthGanZhi}`);
                    }
                    previousMonthGanZhi = monthGanZhi;
                }
                
                // è®¡ç®—æµæœˆåœ°æ”¯è—å¹²çš„åç¥ï¼ˆæµæœˆå˜åŒ–æ—¶æ˜¾ç¤ºï¼‰
                const monthCangGans = getCangGan(monthZhi);
                let monthCangGanShishenHtml = '';
                if (isMonthChanged && monthCangGans.length > 0) {
                    monthCangGanShishenHtml = '<div class="text-xs text-gray-500 mt-1">';
                    monthCangGans.forEach(cg => {
                        const cgShishen = getShiShen(natalGan.D, cg);
                        monthCangGanShishenHtml += `<span class="${getWuxingClass(cg)}">${cg}</span>(${cgShishen}) `;
                    });
                    monthCangGanShishenHtml += '</div>';
                }
                
                // æµæœˆä¸å‘½å±€çš„äº¤äº’ï¼ˆæµæœˆå˜åŒ–æ—¶è®¡ç®—æ˜¾ç¤ºï¼‰
                let monthInteractionNote = '';
                let monthShenshaList = [];
                if (isMonthChanged) {
                    const monthGanNote = checkInteractions(monthGan, natalGan, 'Gan');
                    const monthZhiNote = checkInteractions(monthZhi, natalZhi, 'Zhi');
                    if (monthGanNote || monthZhiNote) {
                        monthInteractionNote = '<div class="mt-1 text-xs">';
                        if (monthGanNote) monthInteractionNote += monthGanNote;
                        if (monthZhiNote) monthInteractionNote += (monthGanNote ? '<br>' : '') + monthZhiNote;
                        monthInteractionNote += '</div>';
                    }
                    
                    // è®¡ç®—æµæœˆç¥ç…
                    monthShenshaList = calculateShenSha(
                        natalGan.D, 
                        natalZhi.D, 
                        natalZhi.Y, 
                        natalZhi.M, 
                        monthZhi,
                        monthGan,
                        null, null, null, null
                    );
                }
                
                // è·å–æµæ—¥å¹²æ”¯
                const dayGan = currentLunar.getDayGan();
                const dayZhi = currentLunar.getDayZhi();
                const dayGanZhi = currentLunar.getDayInGanZhi();
                
                // è®¡ç®—æµæ—¥å¤©å¹²çš„åç¥
                const dayGanShishen = getShiShen(natalGan.D, dayGan);
                
                // äº¤äº’è®¡ç®—
                const ganNote = checkInteractions(dayGan, natalGan, 'Gan');
                const zhiNote = checkInteractions(dayZhi, natalZhi, 'Zhi');
                
                // è®¡ç®—ç¥ç…ï¼ˆæµæ—¥è®¡ç®—åªç”¨æ—¥å¹²æŸ¥æµæ—¥åœ°æ”¯ï¼‰
                const shenshaList = calculateShenSha(
                    natalGan.D, 
                    natalZhi.D, 
                    natalZhi.Y, 
                    natalZhi.M, 
                    dayZhi,
                    dayGan,
                    null, // yearGan - æµæ—¥ä¸éœ€è¦
                    null, // monthGan - æµæ—¥ä¸éœ€è¦
                    null, // timeGan - æµæ—¥ä¸éœ€è¦
                    null  // allZhiList - æµæ—¥ä¸éœ€è¦
                );
                
                // è·å–å»ºé™¤åäºŒç¥
                const jianChu = currentLunar.getZhiXing();
                
                // ç»„åˆç¥ç…æ˜¾ç¤º
                let shenShaHtml = `<span class="text-gray-600 font-semibold">${jianChu}</span>`;
                shenshaList.forEach(ss => {
                    shenShaHtml += `<span class="shensha-tag">${ss}</span>`;
                });
                
                // è·å–å†œå†æ—¥æœŸ
                const lunarDay = currentLunar.getDayInChinese();
                const lunarMonth = currentLunar.getMonthInChinese();
                
                // æ˜ŸæœŸ
                const week = currentSolar.getWeekInChinese();
                
                // ç”Ÿæˆæ¯æ—¥è§£è¯»
                const dailyInterpretation = generateDailyInterpretation(
                    jianChu, shenshaList, ganNote, zhiNote, dayGan, dayZhi,
                    monthGan, monthZhi, natalGan, natalZhi, isMonthChanged, monthShenshaList,
                    yearGan, yearZhi, isYearChanged, yearShenshaList
                );
                
                console.log(`æ¸²æŸ“ç¬¬${d}æ—¥ï¼Œæµå¹´: ${yearGan}${yearZhi}ï¼Œæµæœˆ: ${monthGan}${monthZhi}ï¼Œæµæ—¥: ${dayGan}${dayZhi}ï¼Œå»ºé™¤: ${jianChu}`);
                
                const row = `
                    <tr class="calendar-row hover:bg-gray-50 transition-colors">
                        <td class="p-4 border-b border-gray-200">
                            <div class="font-bold text-gray-800 text-base">${year}-${String(month).padStart(2,'0')}-${String(d).padStart(2,'0')}</div>
                            <div class="text-xs text-gray-500 mt-1">æ˜ŸæœŸ${week}</div>
                        </td>
                        <td class="p-4 border-b border-gray-200">
                            <div class="text-sm text-gray-700">${lunarMonth}æœˆ${lunarDay}</div>
                        </td>
                        <td class="p-4 border-b border-gray-200 bg-gradient-to-br from-blue-50 to-cyan-50">
                            <div class="text-lg font-bold">
                                <span class="${getWuxingClass(yearGan)}">${yearGan}</span>
                                <span class="${getWuxingClass(yearZhi)}">${yearZhi}</span>
                            </div>
                            <div class="text-xs text-gray-600 mt-1 font-medium">${yearGanShishen}</div>
                            ${yearCangGanShishenHtml}
                            ${isYearChanged ? '<div class="text-xs text-blue-600 font-medium mt-1">ğŸŠ æµå¹´äº¤æ›¿</div>' : ''}
                            ${yearInteractionNote}
                        </td>
                        <td class="p-4 border-b border-gray-200 bg-gradient-to-br from-purple-50 to-indigo-50">
                            <div class="text-lg font-bold">
                                <span class="${getWuxingClass(monthGan)}">${monthGan}</span>
                                <span class="${getWuxingClass(monthZhi)}">${monthZhi}</span>
                            </div>
                            <div class="text-xs text-gray-600 mt-1 font-medium">${monthGanShishen}</div>
                            ${monthCangGanShishenHtml}
                            ${isMonthChanged ? '<div class="text-xs text-purple-600 font-medium mt-1">â­ æµæœˆäº¤èŠ‚</div>' : ''}
                            ${monthInteractionNote}
                        </td>
                        <td class="p-4 border-b border-gray-200">
                            <div class="text-xl font-bold">
                                <span class="${getWuxingClass(dayGan)}">${dayGan}</span>
                                <span class="${getWuxingClass(dayZhi)}">${dayZhi}</span>
                            </div>
                            <div class="text-xs text-gray-600 mt-1 font-medium">${dayGanShishen}</div>
                        </td>
                        <td class="p-4 border-b border-gray-200">
                            ${ganNote || '<span class="text-gray-300">-</span>'}
                        </td>
                        <td class="p-4 border-b border-gray-200">
                            ${zhiNote || '<span class="text-gray-300">-</span>'}
                        </td>
                        <td class="p-4 border-b border-gray-200">
                            ${shenShaHtml}
                        </td>
                        <td class="p-4 border-b border-gray-200 text-xs leading-relaxed">
                            ${dailyInterpretation}
                        </td>
                    </tr>
                `;
                tbody.innerHTML += row;
            }
        }

        // é¡µé¢åŠ è½½æ—¶è¿è¡Œä¸€æ¬¡
        window.onload = function() {
            console.log('é¡µé¢åŠ è½½å®Œæˆï¼Œå¼€å§‹è®¡ç®—');
            try {
                calculate();
            } catch (e) {
                console.error('calculateå‡½æ•°æ‰§è¡Œå‡ºé”™:', e);
                alert('è®¡ç®—å‡ºé”™ï¼š' + e.message);
            }
        };
    </script>
</body>
</html>

